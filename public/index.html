<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <!-- PWA Meta Tags -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="CR Golf">
    <meta name="application-name" content="CR Golf">
    <meta name="theme-color" content="#dc2626">
    <meta name="description" content="Company Retreat Golf Tournament - 8 Years of Ryder Cup Excellence">
    
    <!-- iOS Splash Screens -->
    <link rel="apple-touch-icon" href="/icons/icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/icon-180x180.png">
    <link rel="apple-touch-icon" sizes="167x167" href="/icons/icon-167x167.png">
    
    <!-- Manifest -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/icons/icon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/icons/icon-16x16.png" sizes="16x16">
    
    <title>Company Retreat Golf Tournament</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        :root {
            --primary: #dc2626; /* Red as primary */
            --secondary: #1e3a8a; /* Navy blue as secondary */
            --accent: #ef4444; /* Lighter red */
            --gold: #fbbf24;
            --silver: #e5e7eb;
            --bronze: #f97316;
            --bg-dark: #ffffff; /* White background */
            --bg-light: #f9fafb; /* Light gray */
            --text-light: #111827; /* Dark text for white background */
            --text-muted: #6b7280;
            --success: #10b981;
            --danger: #dc2626;
            --card-bg: rgba(255, 255, 255, 0.9);
            --border: rgba(229, 231, 235, 1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #ffffff;
            color: var(--text-light);
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                radial-gradient(circle at 20% 80%, rgba(220, 38, 38, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(30, 58, 138, 0.03) 0%, transparent 50%);
            pointer-events: none;
            z-index: 1;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem 2rem 80px 2rem; /* Add bottom padding for fixed nav */
            position: relative;
            z-index: 2;
        }

        header {
            text-align: center;
            margin-bottom: 3rem;
            animation: fadeInDown 0.8s ease-out;
            position: relative;
        }

        .logo {
            width: 80px;
            height: 80px;
            margin: 0 auto 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo svg {
            width: 100%;
            height: 100%;
        }

        h1 {
            font-size: 3.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            font-size: 1.2rem;
            color: var(--text-muted);
            font-weight: 400;
        }

        .tabs {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            display: flex;
            gap: 0;
            background: var(--bg-dark);
            padding: 0;
            border-top: 1px solid var(--border);
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
            z-index: 100;
            height: 60px;
        }

        .tab {
            flex: 1;
            padding: 0.5rem;
            background: transparent;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 0.75rem;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 0.25rem;
            border-radius: 0;
            position: relative;
        }

        .tab:hover {
            background: rgba(220, 38, 38, 0.1);
            color: var(--primary);
        }

        .tab.active {
            background: transparent;
            color: var(--primary);
            box-shadow: none;
        }

        .tab.active::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--primary);
        }

        .content {
            background: var(--card-bg);
            border-radius: 1.5rem;
            padding: 2rem;
            border: 1px solid var(--border);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            animation: fadeInUp 0.8s ease-out 0.5s both;
            min-height: 600px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: white;
            padding: 1.5rem;
            border-radius: 1rem;
            border: 2px solid var(--primary);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(220, 38, 38, 0.1) 0%, transparent 70%);
            transform: rotate(45deg);
            transition: opacity 0.3s ease;
            opacity: 0;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(220, 38, 38, 0.2);
            border-color: var(--accent);
        }

        .stat-card:hover::before {
            opacity: 1;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .stat-label {
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        th, td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        th {
            background: rgba(220, 38, 38, 0.1);
            font-weight: 600;
            color: var(--primary);
            position: sticky;
            top: 0;
            z-index: 10;
        }

        tr:hover {
            background: rgba(220, 38, 38, 0.05);
        }

        .champion-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: linear-gradient(135deg, var(--gold) 0%, #f59e0b 100%);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 2rem;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .winner {
            color: var(--primary);
            font-weight: 600;
        }

        .loser {
            color: var(--text-muted);
        }

        .player-card {
            background: white;
            padding: 1.5rem;
            border-radius: 1rem;
            border: 2px solid var(--border);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .player-card:hover {
            transform: scale(1.02);
            box-shadow: 0 10px 30px rgba(220, 38, 38, 0.2);
            border-color: var(--primary);
        }

        .player-name {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--secondary);
        }

        .record {
            display: flex;
            gap: 1rem;
            font-size: 0.9rem;
        }

        .wins { color: var(--success); }
        .losses { color: var(--danger); }
        .ties { color: var(--text-muted); }

        .rank-badge {
            position: absolute;
            top: 1rem;
            right: 1rem;
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.1rem;
        }

        .rank-1 { background: var(--gold); color: var(--text-light); }
        .rank-2 { background: var(--silver); color: var(--text-light); }
        .rank-3 { background: var(--bronze); color: white; }

        .year-card {
            background: white;
            border: 2px solid var(--primary);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            transition: all 0.3s ease;
        }

        .year-card:hover {
            box-shadow: 0 5px 20px rgba(220, 38, 38, 0.1);
            border-color: var(--accent);
        }

        .year-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .year-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
        }

        .score {
            font-size: 1.8rem;
            font-weight: 800;
        }

        .captain-info {
            color: var(--text-muted);
            font-size: 0.9rem;
            margin-top: 0.5rem;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .loading {
            text-align: center;
            padding: 3rem;
            color: var(--text-muted);
        }

        .perfect-attendance {
            background: var(--secondary);
            color: white;
            padding: 0.2rem 0.6rem;
            border-radius: 0.3rem;
            font-size: 0.8rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }

        .scrollable {
            max-height: 600px;
            overflow-y: auto;
            padding-right: 0.5rem;
        }

        .scrollable::-webkit-scrollbar {
            width: 8px;
        }

        .scrollable::-webkit-scrollbar-track {
            background: var(--bg-light);
            border-radius: 4px;
        }

        .scrollable::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }

        .scrollable::-webkit-scrollbar-thumb:hover {
            background: var(--accent);
        }

        .filter-buttons {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 0.5rem 1rem;
            background: white;
            border: 2px solid var(--primary);
            border-radius: 0.5rem;
            color: var(--primary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .filter-btn:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
        }

        .filter-btn.active {
            background: var(--primary);
            color: white;
        }

        .stat-of-day {
            background: linear-gradient(135deg, rgba(220, 38, 38, 0.1) 0%, rgba(30, 58, 138, 0.1) 100%);
            border: 2px solid var(--primary);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-top: 2rem;
            text-align: center;
            animation: fadeIn 1s ease-out 0.5s both;
        }

        .stat-of-day .stat-label {
            color: var(--primary);
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .stat-of-day .stat-content {
            color: var(--text-light);
            font-size: 1.1rem;
            line-height: 1.6;
        }

        .stat-highlight {
            color: var(--primary);
            font-weight: 600;
        }

        .metric-card {
            background: white;
            padding: 1.5rem;
            border-radius: 1rem;
            border: 2px solid var(--primary);
            margin-bottom: 1.5rem;
        }

        .metric-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 1rem;
        }

        .metric-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--border);
        }

        .metric-item:last-child {
            border-bottom: none;
        }

        .handicap-trend {
            display: flex;
            gap: 0.5rem;
            align-items: center;
            font-size: 0.9rem;
        }

        .trend-up {
            color: var(--success);
        }

        .trend-down {
            color: var(--danger);
        }

        .upset-marker {
            background: var(--accent);
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: 0.3rem;
            font-size: 0.8rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }
    </style>
    
    <!-- Add XLSX library for reading Excel files -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <img src="/images/company retreat logo simple_color.png" alt="Company Retreat Golf Logo" style="width: 100%; height: 100%; object-fit: contain;">
            </div>
            <h1>Company Retreat</h1>
            <p class="subtitle">8 Years of Ryder Cup Golf Excellence</p>
            <div id="stat-of-day" class="stat-of-day">
                <div class="stat-label">Stat of the Day</div>
                <div class="stat-content"></div>
            </div>
        </header>

        <div class="tabs">
            <button class="tab active" onclick="showTab('home')">
                <span style="font-size: 1.2rem;">🏠</span>
                <span>2025</span>
            </button>
            <button class="tab" onclick="showTab('matches')">
                <span style="font-size: 1.2rem;">⛳</span>
                <span>Matches</span>
            </button>
            <button class="tab" onclick="showTab('players')">
                <span style="font-size: 1.2rem;">👥</span>
                <span>Players</span>
            </button>
            <button class="tab" onclick="showTab('analytics')">
                <span style="font-size: 1.2rem;">📊</span>
                <span>Analytics</span>
            </button>
            <button class="tab" onclick="showTab('history')">
                <span style="font-size: 1.2rem;">🏆</span>
                <span>History</span>
            </button>
            <button class="tab" onclick="showTab('trends')">
                <span style="font-size: 1.2rem;">📈</span>
                <span>Trends</span>
            </button>
        </div>

        <div class="content" id="content">
            <div class="loading">Loading tournament data...</div>
        </div>
    </div>

    <script>
        // Tournament Data (will be loaded from Excel)
        // const tournamentData = {
            years: {
                2018: { winner: "Portal", loser: "Pete", score: "9-7", captains: { Portal: "Javi Portal", Pete: "Pete Cabrera" } },
                2019: { winner: "Al", loser: "Skip", score: "9-7", captains: { Al: "Alex Lastra", Skip: "Skippy Ramirez" } },
                2020: { winner: "Vic", loser: "Javi", score: "15-9", captains: { Vic: "Victor Riobueno", Javi: "Javi Vargas" } },
                2021: { winner: "Danny", loser: "Mario", score: "15.5-8.5", captains: { Danny: "Danny Yanez", Mario: "Mario Martinez" } },
                2022: { winner: "Jo", loser: "Shawn", score: "12.5-11.5", captains: { Jo: "Jo Noy", Shawn: "Shawn Noy" } },
                2023: { winner: "Stu", loser: "Wes", score: "13-11", captains: { Stu: "Stuart Briggle", Wes: "Wes Briggle" } },
                2024: { winner: "Victor", loser: "Carlos", score: "15-13", captains: { Victor: "Victor Garcia", Carlos: "Carlos Enjamio" } },
                2025: { winner: "Pardo", loser: "Salas", score: "15.5-8.5", captains: { Pardo: "Lawrence Pardo", Salas: "Javi Salas" } }
            },
            players: [
                { rank: 1, name: "Danny Yanez", crs: 8, wins: 19, losses: 5, ties: 0, rating: 652, perfectAttendance: true },
                { rank: 2, name: "Javi Portal", crs: 8, wins: 14, losses: 9, ties: 1, rating: 582, perfectAttendance: true },
                { rank: 3, name: "Alex Lastra", crs: 7, wins: 15, losses: 5, ties: 1, rating: 504 },
                { rank: 4, name: "Jordan Portal", crs: 7, wins: 13, losses: 8, ties: 0, rating: 473 },
                { rank: 5, name: "Pete Cabrera", crs: 8, wins: 12, losses: 12, ties: 0, rating: 451, perfectAttendance: true },
                { rank: 6, name: "Victor Riobueno", crs: 8, wins: 12, losses: 11, ties: 1, rating: 451, perfectAttendance: true },
                { rank: 7, name: "Javi Vargas", crs: 7, wins: 9, losses: 10, ties: 2, rating: 425 },
                { rank: 8, name: "Carlos Enjamio", crs: 6, wins: 8, losses: 7, ties: 3, rating: 416 },
                { rank: 9, name: "Lawrence Pardo", crs: 7, wins: 9, losses: 9, ties: 3, rating: 416 },
                { rank: 10, name: "Michael Quintana", crs: 6, wins: 9, losses: 7, ties: 2, rating: 398 },
                { rank: 11, name: "Boogie Lastra", crs: 5, wins: 8, losses: 7, ties: 0, rating: 383, neverWon: true },
                { rank: 12, name: "Carlos Alfonso", crs: 5, wins: 8, losses: 7, ties: 0, rating: 383 },
                { rank: 13, name: "Jo Noy", crs: 6, wins: 9, losses: 9, ties: 0, rating: 378 },
                { rank: 14, name: "Shawn Noy", crs: 5, wins: 5, losses: 9, ties: 1, rating: 320, neverWon: true },
                { rank: 15, name: "Mario Martinez", crs: 4, wins: 5, losses: 7, ties: 0, rating: 300, neverWon: true },
                { rank: 16, name: "David Del Cristo", crs: 4, wins: 5, losses: 6, ties: 1, rating: 295, neverWon: true }
            ]
        };

        // Complete course data for all years
        const courseData = {
            2020: {
                scramble: { course: "West Palm Beach Par 3", rating: 52.9, slope: 113 },
                bestBall: { course: "Abacoa Golf Club (White)", rating: 70.2, slope: 132 },
                singles: { course: "Trump Doral Red Tiger (Gold)", rating: 69.6, slope: 132 }
            },
            2021: {
                scramble: { course: "Disney's Magnolia", rating: 69.6, slope: 126 },
                bestBall: { course: "Disney's Palm (Gold)", rating: 68.7, slope: 124 },
                singles: { course: "Southern Dunes (White)", rating: 70.4, slope: 133 }
            },
            2022: {
                scramble: { course: "Royal St. Cloud", rating: 70.9, slope: 126 },
                bestBall: { course: "Reunion Watson (Blue)", rating: 70.8, slope: 126 },
                singles: { course: "Reunion Nicklaus (Blue)", rating: 71.4, slope: 133 }
            },
            2023: {
                scramble: { course: "Reunion Nicklaus (Blue)", rating: 71.4, slope: 133 },
                bestBall: { course: "Grand Cypress Links (Blue)", rating: 70.4, slope: 117 },
                singles: { course: "Celebration (Gold)", rating: 72.1, slope: 135 }
            },
            2024: {
                scramble: { course: "Reunion Palmer (Gold)", rating: 70.9, slope: 133 },
                bestBall: { course: "OC National Panther Lake", rating: 71.2, slope: 132 },
                singles: { course: "Champions Gate Int'l (Blue)", rating: 73.0, slope: 132 }
            },
            2025: {
                scramble: { course: "Reunion Palmer (Gold)", rating: 70.9, slope: 133 },
                bestBall: { course: "Disney's Magnolia (White)", rating: 71.6, slope: 130 },
                singles: { course: "Waldorf Astoria (Blue/White)", rating: 71.7, slope: 137 }
            }
        };

        // Initialize empty data structures
        let matchData = {};
        let handicapData = {};
        let tournamentData = {
            players: [],
            captainHistory: []
        };

        // Function to load and parse Excel data
        async function loadExcelData() {
            try {
                const response = await fetch('/CR History.xlsx');
                const arrayBuffer = await response.arrayBuffer();
                const data = new Uint8Array(arrayBuffer);
                const workbook = XLSX.read(data, { type: 'array' });
                
                // Process Players sheet for overall stats
                const playersSheet = workbook.Sheets['Players'];
                if (playersSheet) {
                    const playersData = XLSX.utils.sheet_to_json(playersSheet);
                    
                    // Update tournament data with player stats
                    tournamentData.players = playersData.map((player, idx) => ({
                        rank: player.Rank || idx + 1,
                        name: player.Player,
                        crs: player.CRs || 0,
                        wins: player.W || 0,
                        losses: player.L || 0,
                        ties: player.T || 0,
                        rating: player.Rating || 0,
                        perfectAttendance: player.CRs === 8,
                        neverWon: false // Will be calculated from match data
                    })).filter(p => p.name); // Filter out empty rows
                }
                
                // Process each year's data
                const years = ['2018', '2019', '2020', '2021', '2022', '2023', '2024', '2025'];
                
                for (const year of years) {
                    const sheet = workbook.Sheets[year];
                    if (!sheet) continue;
                    
                    const yearData = XLSX.utils.sheet_to_json(sheet);
                    matchData[year] = processYearData(year, yearData);
                    
                    // Extract handicap data
                    yearData.forEach(player => {
                        if (player.Player && player.HCP !== undefined) {
                            if (!handicapData[player.Player]) {
                                handicapData[player.Player] = {};
                            }
                            handicapData[player.Player][year] = player.HCP;
                        }
                    });
                }
                
                // Update tournament years data
                tournamentData.years = {
                    2025: { winner: "Pardo", loser: "Salas", score: "15.5-8.5", captains: { Pardo: "Lawrence Pardo", Salas: "Javi Salas" } },
                    2024: { winner: "Victor", loser: "Carlos", score: "15-13", captains: { Victor: "Victor Garcia", Carlos: "Carlos Enjamio" } },
                    2023: { winner: "Stu", loser: "Wes", score: "13-11", captains: { Stu: "Stuart Briggle", Wes: "Wes Briggle" } },
                    2022: { winner: "Jo", loser: "Shawn", score: "12.5-11.5", captains: { Jo: "Jo Noy", Shawn: "Shawn Noy" } },
                    2021: { winner: "Danny", loser: "Mario", score: "15.5-8.5", captains: { Danny: "Danny Yanez", Mario: "Mario Martinez" } },
                    2020: { winner: "Vic", loser: "Javi", score: "15-9", captains: { Vic: "Victor Riobueno", Javi: "Javi Vargas" } },
                    2019: { winner: "Al", loser: "Skip", score: "9-7", captains: { Al: "Alex Lastra", Skip: "Skippy Ramirez" } },
                    2018: { winner: "Portal", loser: "Pete", score: "9-7", captains: { Portal: "Javi Portal", Pete: "Pete Cabrera" } }
                };
                
                console.log('Excel data loaded successfully');
                
                // Initialize the app with the loaded data
                showTab('home');
                displayRandomStat();
                
            } catch (error) {
                console.error('Error loading Excel file:', error);
                // Fall back to hardcoded data if Excel fails
                loadFallbackData();
            }
        }

        function processYearData(year, yearData) {
            const result = {
                date: getYearDate(year),
                courses: getYearCourses(year),
                captains: getYearCaptains(year),
                finalScore: getYearScore(year),
                scrambleResults: [],
                bestBallResults: [],
                singlesResults: [],
                teamData: {},
                dailyScores: { friday: {}, saturday: {}, sunday: {} }
            };
            
            // Group players by team
            const teams = {};
            yearData.forEach(player => {
                if (player.Team && player.Player) {
                    if (!teams[player.Team]) teams[player.Team] = [];
                    teams[player.Team].push(player.Player);
                }
            });
            result.teamData = teams;
            
            // Extract Scramble matches (avoiding duplicates)
            const scramblePairs = new Map();
            yearData.forEach(player => {
                if (player.Player && player.Scramble && player.Team) {
                    const pair = [player.Player, player.Scramble].sort().join('|');
                    if (!scramblePairs.has(pair)) {
                        scramblePairs.set(pair, {
                            players: [player.Player, player.Scramble],
                            team: player.Team,
                            result: player.Result || '',
                            score: formatScore(player['Up/Dn'], player.Left)
                        });
                    }
                }
            });
            
            // Convert scramble pairs to match format
            const scrambleArray = Array.from(scramblePairs.values());
            const teamNames = Object.keys(teams);
            
            // Group by actual matches (need to pair up opposing teams)
            for (let i = 0; i < scrambleArray.length; i++) {
                const match1 = scrambleArray[i];
                if (match1.result) {
                    result.scrambleResults.push({
                        match: result.scrambleResults.length + 1,
                        [teamNames[0].toLowerCase()]: match1.team === teamNames[0] ? match1.players : null,
                        [teamNames[1].toLowerCase()]: match1.team === teamNames[1] ? match1.players : null,
                        result: match1.result,
                        score: match1.score
                    });
                }
            }
            
            // Extract Best Ball matches (similar logic)
            const bestBallPairs = new Map();
            yearData.forEach(player => {
                if (player.Player && player['Best Ball'] && player.Team) {
                    const pair = [player.Player, player['Best Ball']].sort().join('|');
                    if (!bestBallPairs.has(pair)) {
                        bestBallPairs.set(pair, {
                            players: [player.Player, player['Best Ball']],
                            team: player.Team,
                            result: player.Result_1 || player['Result.1'] || '',
                            score: formatScore(player['Up/Dn_1'] || player['Up/Dn.1'], player.Left_1 || player['Left.1'])
                        });
                    }
                }
            });
            
            // Extract Singles matches
            const singlesMatches = new Map();
            yearData.forEach(player => {
                if (player.Player && player.Singles && player.Team) {
                    const key = player.Player;
                    if (!singlesMatches.has(key)) {
                        singlesMatches.set(key, {
                            player: player.Player,
                            team: player.Team,
                            opponent: player.Singles,
                            result: player.Result_2 || player['Result.2'] || '',
                            score: formatScore(player['Up/Dn_2'] || player['Up/Dn.2'], player.Left_2 || player['Left.2'])
                        });
                    }
                }
            });
            
            result.singlesResults = Array.from(singlesMatches.values()).map((match, idx) => ({
                match: idx + 1,
                [teamNames[0].toLowerCase()]: match.team === teamNames[0] ? match.player : match.opponent,
                [teamNames[1].toLowerCase()]: match.team === teamNames[1] ? match.player : match.opponent,
                result: match.result,
                score: match.score
            }));
            
            // Calculate daily scores
            let team1Scramble = 0, team2Scramble = 0;
            let team1BestBall = 0, team2BestBall = 0;
            let team1Singles = 0, team2Singles = 0;
            
            yearData.forEach(player => {
                if (player.Team === teamNames[0]) {
                    if (player.Result === 'W') team1Scramble += 0.5;
                    if (player.Result === 'T') team1Scramble += 0.25;
                    if (player.Result_1 === 'W' || player['Result.1'] === 'W') team1BestBall += 0.5;
                    if (player.Result_1 === 'T' || player['Result.1'] === 'T') team1BestBall += 0.25;
                    if (player.Result_2 === 'W' || player['Result.2'] === 'W') team1Singles += 1;
                    if (player.Result_2 === 'T' || player['Result.2'] === 'T') team1Singles += 0.5;
                } else if (player.Team === teamNames[1]) {
                    if (player.Result === 'W') team2Scramble += 0.5;
                    if (player.Result === 'T') team2Scramble += 0.25;
                    if (player.Result_1 === 'W' || player['Result.1'] === 'W') team2BestBall += 0.5;
                    if (player.Result_1 === 'T' || player['Result.1'] === 'T') team2BestBall += 0.25;
                    if (player.Result_2 === 'W' || player['Result.2'] === 'W') team2Singles += 1;
                    if (player.Result_2 === 'T' || player['Result.2'] === 'T') team2Singles += 0.5;
                }
            });
            
            result.dailyScores.friday[teamNames[0].toLowerCase()] = team1Scramble;
            result.dailyScores.friday[teamNames[1].toLowerCase()] = team2Scramble;
            result.dailyScores.saturday[teamNames[0].toLowerCase()] = team1BestBall;
            result.dailyScores.saturday[teamNames[1].toLowerCase()] = team2BestBall;
            result.dailyScores.sunday[teamNames[0].toLowerCase()] = team1Singles;
            result.dailyScores.sunday[teamNames[1].toLowerCase()] = team2Singles;
            
            return result;
        }

        // Helper functions
        function formatScore(upDown, left) {
            if (upDown && left) {
                return `${Math.abs(upDown)}&${left}`;
            } else if (upDown === 0) {
                return 'Halved';
            }
            return '';
        }

        function getYearDate(year) {
            const dates = {
                '2025': 'January 17-19, 2025',
                '2024': 'January 19-21, 2024',
                '2023': 'January 20-22, 2023',
                '2022': 'January 21-23, 2022',
                '2021': 'January 22-24, 2021',
                '2020': 'September 11-13, 2020',
                '2019': 'January 2019',
                '2018': 'January 2018'
            };
            return dates[year] || '';
        }

        function getYearCaptains(year) {
            const captains = {
                '2025': { pardo: "Lawrence Pardo", salas: "Javi Salas" },
                '2024': { victor: "Victor Garcia", carlos: "Carlos Enjamio" },
                '2023': { stu: "Stuart Briggle", wes: "Wes Briggle" },
                '2022': { jo: "Jo Noy", shawn: "Shawn Noy" },
                '2021': { danny: "Danny Yanez", mario: "Mario Martinez" },
                '2020': { vic: "Victor Riobueno", javi: "Javi Vargas" },
                '2019': { al: "Alex Lastra", skip: "Skippy Ramirez" },
                '2018': { portal: "Javi Portal", pete: "Pete Cabrera" }
            };
            return captains[year] || {};
        }

        function getYearScore(year) {
            const scores = {
                '2025': '15.5-8.5',
                '2024': '15-13',
                '2023': '13-11',
                '2022': '12.5-11.5',
                '2021': '15.5-8.5',
                '2020': '15-9',
                '2019': '9-7',
                '2018': '9-7'
            };
            return scores[year] || '';
        }

        function getYearCourses(year) {
            const courses = {
                '2025': {
                    scramble: { name: "Reunion Palmer (Gold)", rating: 70.9, slope: 133 },
                    bestBall: { name: "Disney's Magnolia (White)", rating: 71.6, slope: 130 },
                    singles: { name: "Waldorf Astoria (Blue/White)", rating: 71.7, slope: 137 }
                },
                '2024': {
                    scramble: { name: "Reunion Palmer (Gold)", rating: 70.9, slope: 133 },
                    bestBall: { name: "OC National Panther Lake", rating: 71.2, slope: 132 },
                    singles: { name: "Champions Gate Int'l (Blue)", rating: 73.0, slope: 132 }
                },
                // Add more years as needed
            };
            return courses[year] || { scramble: {}, bestBall: {}, singles: {} };
        }

        // Fallback function to restore hardcoded data if Excel fails
        function loadFallbackData() {
            console.log('Loading fallback data...');
            
            // Restore hardcoded tournament data
            tournamentData.years = {
                2025: { winner: "Pardo", loser: "Salas", score: "15.5-8.5", captains: { Pardo: "Lawrence Pardo", Salas: "Javi Salas" } },
                2024: { winner: "Victor", loser: "Carlos", score: "15-13", captains: { Victor: "Victor Garcia", Carlos: "Carlos Enjamio" } },
                2023: { winner: "Stu", loser: "Wes", score: "13-11", captains: { Stu: "Stuart Briggle", Wes: "Wes Briggle" } },
                2022: { winner: "Jo", loser: "Shawn", score: "12.5-11.5", captains: { Jo: "Jo Noy", Shawn: "Shawn Noy" } },
                2021: { winner: "Danny", loser: "Mario", score: "15.5-8.5", captains: { Danny: "Danny Yanez", Mario: "Mario Martinez" } },
                2020: { winner: "Vic", loser: "Javi", score: "15-9", captains: { Vic: "Victor Riobueno", Javi: "Javi Vargas" } },
                2019: { winner: "Al", loser: "Skip", score: "9-7", captains: { Al: "Alex Lastra", Skip: "Skippy Ramirez" } },
                2018: { winner: "Portal", loser: "Pete", score: "9-7", captains: { Portal: "Javi Portal", Pete: "Pete Cabrera" } }
            };
            
            // Initialize the app with fallback data
            showTab('home');
            displayRandomStat();
        }

        // Load Excel data when page loads
        window.addEventListener('load', () => {
            loadExcelData();
        });

        // Temporary hardcoded data for fallback
        const matchDataFallback = {
            2025: {
                date: "January 17-19, 2025",
                courses: {
                    scramble: { name: "Reunion Palmer (Gold)", rating: 70.9, slope: 133 },
                    bestBall: { name: "Disney's Magnolia (White)", rating: 71.6, slope: 130 },
                    singles: { name: "Waldorf Astoria (Blue/White)", rating: 71.7, slope: 137 }
                },
                captains: { pardo: "Lawrence Pardo", salas: "Javi Salas" },
                finalScore: "15.5-8.5",
                teamPardo: ["Lawrence Pardo", "Javi Portal", "Alex Lastra", "Michael Quintana", "Danny Yanez", "Jo Noy", "Roger De Armas", "Jordan Portal", "Skippy Ramirez", "Andrew Guasch", "Javi Vargas", "Eric Diaz"],
                teamSalas: ["Javi Salas", "Pete Cabrera", "Carlos Alfonso", "Boogie Lastra", "Victor Riobueno", "Mario Martinez", "Carlos Enjamio", "David Del Cristo", "Shawn Noy", "Mauricio Restrepo", "Stefano Diaz", "Joey Pinto"],
                scrambleResults: [
                    { match: 1, pardo: ["Pardo", "Quintana"], salas: ["Salas", "Enjamio"], result: "W", score: "2&1", pardoScore: 1, salasScore: 0 },
                    { match: 2, pardo: ["J. Portal", "Jo. Portal"], salas: ["Alfonso", "Cabrera"], result: "W", score: "3&2", pardoScore: 1, salasScore: 0 },
                    { match: 3, pardo: ["Yanez", "Noy"], salas: ["B. Lastra", "Riobueno"], result: "L", score: "2&1", pardoScore: 0, salasScore: 1 },
                    { match: 4, pardo: ["A. Lastra", "Vargas"], salas: ["Martinez", "S. Diaz"], result: "W", score: "3&2", pardoScore: 1, salasScore: 0 },
                    { match: 5, pardo: ["Guasch", "De Armas"], salas: ["Del Cristo", "Restrepo"], result: "W", score: "4&3", pardoScore: 1, salasScore: 0 },
                    { match: 6, pardo: ["Ramirez", "E. Diaz"], salas: ["S. Noy", "Pinto"], result: "W", score: "5&4", pardoScore: 1, salasScore: 0 }
                ],
                bestBallResults: [
                    { match: 1, pardo: ["Pardo", "Yanez"], salas: ["Enjamio", "Salas"], result: "W", score: "1 up", pardoScore: 1, salasScore: 0 },
                    { match: 2, pardo: ["J. Portal", "Jo. Portal"], salas: ["Cabrera", "Alfonso"], result: "W", score: "4&3", pardoScore: 1, salasScore: 0 },
                    { match: 3, pardo: ["Quintana", "Noy"], salas: ["Riobueno", "Martinez"], result: "W", score: "3&2", pardoScore: 1, salasScore: 0 },
                    { match: 4, pardo: ["A. Lastra", "Vargas"], salas: ["B. Lastra", "S. Diaz"], result: "W", score: "3&2", pardoScore: 1, salasScore: 0 },
                    { match: 5, pardo: ["Guasch", "De Armas"], salas: ["Del Cristo", "Restrepo"], result: "L", score: "1 up", pardoScore: 0, salasScore: 1 },
                    { match: 6, pardo: ["Ramirez", "E. Diaz"], salas: ["S. Noy", "Pinto"], result: "T", score: "Halved", pardoScore: 0.5, salasScore: 0.5 }
                ],
                singlesResults: [
                    { match: 1, pardo: "Jordan Portal", salas: "Stefano Diaz", result: "W", score: "6&4", pardoScore: 1, salasScore: 0 },
                    { match: 2, pardo: "Danny Yanez", salas: "Carlos Enjamio", result: "W", score: "3&2", pardoScore: 1, salasScore: 0 },
                    { match: 3, pardo: "Javi Portal", salas: "Pete Cabrera", result: "T", score: "Halved", pardoScore: 0.5, salasScore: 0.5 },
                    { match: 4, pardo: "Alex Lastra", salas: "Carlos Alfonso", result: "W", score: "6&5", pardoScore: 1, salasScore: 0 },
                    { match: 5, pardo: "Michael Quintana", salas: "Victor Riobueno", result: "L", score: "4&3", pardoScore: 0, salasScore: 1 },
                    { match: 6, pardo: "Jo Noy", salas: "Boogie Lastra", result: "L", score: "1 up", pardoScore: 0, salasScore: 1 },
                    { match: 7, pardo: "Lawrence Pardo", salas: "Javi Salas", result: "W", score: "2&1", pardoScore: 1, salasScore: 0 }
                ],
                dailyScores: {
                    friday: { pardo: 5, salas: 1 },
                    saturday: { pardo: 4.5, salas: 1.5 },
                    sunday: { pardo: 4.5, salas: 2.5 }
                }
            },
            2024: {
                date: "January 19-21, 2024",
                courses: {
                    scramble: { name: "Reunion Palmer (Gold)", rating: 70.9, slope: 133 },
                    bestBall: { name: "OC National Panther Lake", rating: 71.2, slope: 132 },
                    singles: { name: "Champions Gate Int'l (Blue)", rating: 73.0, slope: 132 }
                },
                captains: { victor: "Victor Garcia", carlos: "Carlos Enjamio" },
                finalScore: "15-13",
                teamVictor: ["Victor Garcia", "Danny Yanez", "Javi Portal", "Jordan Portal", "Jo Noy", "Alex Lastra", "Mauricio Restrepo", "Luis Sandoval", "Roger De Armas", "Andrew Guasch", "Mikey Newmeyer", "Javi Vargas", "Eric Diaz", "Mike Socarras"],
                teamCarlos: ["Carlos Enjamio", "Pete Cabrera", "Victor Riobueno", "Lawrence Pardo", "Javi Salas", "Michael Quintana", "Boogie Lastra", "Carlos Alfonso", "Ernesto Ibanez", "David Del Cristo", "Shawn Noy", "Ricky Escobar", "Stefano Diaz", "Kevin Samlut"],
                dailyScores: {
                    friday: { victor: 3.5, carlos: 2.5 },
                    saturday: { victor: 5.5, carlos: 4.5 },
                    sunday: { victor: 6, carlos: 6 }
                }
            },
            2023: {
                date: "January 20-22, 2023",
                courses: {
                    scramble: { name: "Reunion Nicklaus (Blue)", rating: 71.4, slope: 133 },
                    bestBall: { name: "Grand Cypress Links (Blue)", rating: 70.4, slope: 117 },
                    singles: { name: "Celebration (Gold)", rating: 72.1, slope: 135 }
                },
                captains: { stu: "Stuart Briggle", wes: "Wes Briggle" },
                finalScore: "13-11",
                dailyScores: {
                    friday: { stu: 4, wes: 2 },
                    saturday: { stu: 4, wes: 4 },
                    sunday: { stu: 5, wes: 5 }
                }
            },
            2022: {
                date: "January 21-23, 2022",
                courses: {
                    scramble: { name: "Royal St. Cloud", rating: 70.9, slope: 126 },
                    bestBall: { name: "Reunion Watson (Blue)", rating: 70.8, slope: 126 },
                    singles: { name: "Reunion Nicklaus (Blue)", rating: 71.4, slope: 133 }
                },
                captains: { jo: "Jo Noy", shawn: "Shawn Noy" },
                finalScore: "12.5-11.5",
                dailyScores: {
                    friday: { jo: 4, shawn: 2 },
                    saturday: { jo: 3, shawn: 5 },
                    sunday: { jo: 5.5, shawn: 4.5 }
                }
            },
            2021: {
                date: "January 22-24, 2021",
                courses: {
                    scramble: { name: "Disney's Magnolia", rating: 69.6, slope: 126 },
                    bestBall: { name: "Disney's Palm (Gold)", rating: 68.7, slope: 124 },
                    singles: { name: "Southern Dunes (White)", rating: 70.4, slope: 133 }
                },
                captains: { danny: "Danny Yanez", mario: "Mario Martinez" },
                finalScore: "15.5-8.5",
                dailyScores: {
                    friday: { danny: 5, mario: 1 },
                    saturday: { danny: 5, mario: 3 },
                    sunday: { danny: 5.5, mario: 4.5 }
                }
            },
            2020: {
                date: "September 11-13, 2020",
                courses: {
                    scramble: { name: "West Palm Beach Par 3", rating: 52.9, slope: 113 },
                    bestBall: { name: "Abacoa Golf Club (White)", rating: 70.2, slope: 132 },
                    singles: { name: "Trump Doral Red Tiger (Gold)", rating: 69.6, slope: 132 }
                },
                captains: { vic: "Victor Riobueno", javi: "Javi Vargas" },
                finalScore: "15-9"
            },
            2019: {
                date: "January 2019",
                captains: { al: "Alex Lastra", skip: "Skippy Ramirez" },
                finalScore: "9-7"
            },
            2018: {
                date: "January 2018",
                captains: { portal: "Javi Portal", pete: "Pete Cabrera" },
                finalScore: "9-7"
            }
        };

        // Complete player handicap progression data (will be loaded from Excel)
        // const handicapData = {
            "Danny Yanez": { 2018: 16, 2019: 14, 2020: 12, 2021: 10, 2022: 9, 2023: 8.5, 2024: 8, 2025: 8 },
            "Jordan Portal": { 2019: 0.5, 2020: 0, 2021: -0.5, 2022: -1, 2023: -2, 2024: -2.5, 2025: -3.1 },
            "Javi Portal": { 2018: 0, 2019: 0, 2020: 0.5, 2021: 0.5, 2022: 1, 2023: 1, 2024: 1.5, 2025: 1.5 },
            "Carlos Enjamio": { 2018: 25, 2019: 22, 2020: 20, 2021: 18, 2022: 16, 2023: 15, 2024: 14, 2025: 13.3 },
            "Victor Riobueno": { 2018: 22.1, 2019: 20, 2020: 19, 2021: 17.5, 2022: 16, 2023: 15.5, 2024: 15, 2025: 14.4 },
            "Pete Cabrera": { 2018: 8, 2019: 7.5, 2020: 7, 2021: 6.5, 2022: 6.1, 2023: 7, 2024: 7.5, 2025: 8 },
            "Alex Lastra": { 2019: 26.5, 2020: 24, 2021: 23, 2022: 22, 2023: 21, 2024: 20.5 },
            "Lawrence Pardo": { 2019: 23, 2020: 21, 2021: 19, 2022: 17, 2023: 16, 2024: 15, 2025: 14 },
            "Michael Quintana": { 2020: 16, 2021: 15, 2022: 14, 2023: 13.5, 2024: 13, 2025: 12.5 },
            "Jo Noy": { 2020: 16, 2021: 15, 2022: 14, 2023: 13, 2024: 12, 2025: 11.5 },
            "Shawn Noy": { 2021: 20, 2022: 19, 2023: 18.5, 2024: 18, 2025: 17.5 },
            "Boogie Lastra": { 2021: 28, 2022: 26, 2023: 24.5, 2024: 23.5, 2025: 22.8 },
            "Carlos Alfonso": { 2021: 20, 2022: 19, 2023: 18, 2024: 17, 2025: 16.5 },
            "Stefano Diaz": { 2024: 2.5, 2025: 0.5 },
            "Andrew Guasch": { 2024: 10, 2025: 9 },
            "Javi Vargas": { 2019: 20, 2020: 19.5, 2021: 19, 2022: 18.5, 2023: 18, 2024: 17.5, 2025: 17 },
            "Mario Martinez": { 2021: 10, 2022: 9.5, 2023: 9, 2024: 8.5 },
            "David Del Cristo": { 2021: 25, 2022: 24, 2023: 23, 2024: 22 },
            "Eric Diaz": { 2022: 25, 2023: 24.5, 2024: 24, 2025: 24 },
            "Mauricio Restrepo": { 2020: 30, 2021: 28, 2022: 26, 2023: 25, 2024: 24, 2025: 23 },
            "Roger De Armas": { 2024: 17, 2025: 16 },
            "Luis Sandoval": { 2023: 15, 2024: 14, 2025: 13 },
            "Kevin Samlut": { 2024: 20, 2025: 19 },
            "Ricky Escobar": { 2022: 18, 2023: 17, 2024: 16, 2025: 15 },
            "Joey Pinto": { 2025: 30 },
            "Javi Salas": { 2022: 12, 2023: 11, 2024: 10, 2025: 9.5 },
            "Skippy Ramirez": { 2019: 15, 2020: 14, 2025: 16 }
        };

        // Head-to-head records
        const headToHeadData = {};

        // Calculate head-to-head from match data
        function calculateHeadToHead() {
            // This would process all match data to build H2H records
            // Implementation would go through each year's results
        }

        // Advanced Analytics Functions
        function calculateStrengthOfSchedule(playerName) {
            // Calculate average opponent handicap faced
            let opponentHandicaps = [];
            let matchesAnalyzed = 0;
            
            // Look through all match data to find opponents
            // This would need full match history implementation
            
            return {
                avgOpponentHcp: 0,
                toughestOpponent: "",
                easiestOpponent: "",
                matchesVsElite: 0,
                winRateVsElite: 0
            };
        }

        function calculateClutchRating(playerName) {
            // Analyze performance in close matches (1 up, 2&1, halved)
            // Analyze performance when match determines team outcome
            return {
                closeMatchRecord: "0-0-0",
                clutchRating: 0,
                pressureWinRate: 0
            };
        }

        function findLuckiestPlayers() {
            // Players who faced opponents playing below their handicap
            // Players who avoided elite players most often
            return [];
        }

        function findUnluckiestPlayers() {
            // Players who consistently faced hot opponents
            // Players with toughest strength of schedule
            return [];
        }

        function calculateMomentumScore() {
            // Track how often teams winning Friday maintain lead
            // Identify biggest comebacks
            return {
                fridayWinners: 0,
                saturdayMomentumShifts: 0,
                sundayCloseouts: 0
            };
        }

        function generateInsightfulStats() {
            // Generate actually interesting statistics
            const insights = [
                "Team Pardo's 15.5-8.5 victory featured a 9.5-2.5 Saturday/Sunday surge after trailing 4-2 on Friday",
                "Jordan Portal (+3.1) gave strokes to every opponent in 2025, still went 2-0-1",
                "Danny Yanez has won 14 of his last 16 matches dating back to 2022",
                "Carlos Enjamio went 3-0 in 2024 but his team lost; went 0-2-1 in 2025 but his team lost again",
                "The Portal brothers are 11-3-1 when paired together in team formats",
                "Victor Riobueno has the toughest strength of schedule, facing an average 8.2 handicap",
                "Teams winning Friday Scrambles have gone on to win the CR 6 of 8 times",
                "Andrew Guasch (6-2) has the best win percentage among players with 2+ CRs",
                "2025 featured the most lopsided singles day ever: 4.5-2.5 for Team Pardo",
                "Pete Cabrera has alternated W-L-W-L-W-L-W-L in his last 8 matches"
            ];
            
            const now = new Date();
            const dayOfYear = Math.floor((now - new Date(now.getFullYear(), 0, 0)) / (1000 * 60 * 60 * 24));
            return insights[dayOfYear % insights.length];
        }

        function calculateFormatSpecialists() {
            const formatStats = {};
            
            playerList.forEach(player => {
                formatStats[player] = {
                    fourball: { wins: 0, total: 0, rate: 0 },
                    altShot: { wins: 0, total: 0, rate: 0 },
                    singles: { wins: 0, total: 0, rate: 0 }
                };
            });
            
            // Process all matches
            Object.values(matchData).forEach(yearData => {
                yearData.matches.forEach(match => {
                    // Process fourball
                    if (match.type === 'Fourball') {
                        match.players.pardo.forEach(player => {
                            if (formatStats[player]) {
                                formatStats[player].fourball.total++;
                                if (match.winner === 'pardo') {
                                    formatStats[player].fourball.wins++;
                                }
                            }
                        });
                        match.players.salas.forEach(player => {
                            if (formatStats[player]) {
                                formatStats[player].fourball.total++;
                                if (match.winner === 'salas') {
                                    formatStats[player].fourball.wins++;
                                }
                            }
                        });
                    }
                    // Process alt shot
                    else if (match.type === 'Alt Shot') {
                        match.players.pardo.forEach(player => {
                            if (formatStats[player]) {
                                formatStats[player].altShot.total++;
                                if (match.winner === 'pardo') {
                                    formatStats[player].altShot.wins++;
                                }
                            }
                        });
                        match.players.salas.forEach(player => {
                            if (formatStats[player]) {
                                formatStats[player].altShot.total++;
                                if (match.winner === 'salas') {
                                    formatStats[player].altShot.wins++;
                                }
                            }
                        });
                    }
                    // Process singles
                    else if (match.type === 'Singles') {
                        match.players.pardo.forEach(player => {
                            if (formatStats[player]) {
                                formatStats[player].singles.total++;
                                if (match.winner === 'pardo') {
                                    formatStats[player].singles.wins++;
                                }
                            }
                        });
                        match.players.salas.forEach(player => {
                            if (formatStats[player]) {
                                formatStats[player].singles.total++;
                                if (match.winner === 'salas') {
                                    formatStats[player].singles.wins++;
                                }
                            }
                        });
                    }
                });
            });
            
            // Calculate win rates
            Object.values(formatStats).forEach(stats => {
                if (stats.fourball.total > 0) {
                    stats.fourball.rate = stats.fourball.wins / stats.fourball.total;
                }
                if (stats.altShot.total > 0) {
                    stats.altShot.rate = stats.altShot.wins / stats.altShot.total;
                }
                if (stats.singles.total > 0) {
                    stats.singles.rate = stats.singles.wins / stats.singles.total;
                }
            });
            
            return formatStats;
        }

        function analyzePredictivePatterns() {
            return [
                {
                    description: "Friday winners take tournament",
                    strength: "75% accuracy"
                },
                {
                    description: "Singles decides close matches",
                    strength: "6 of 8 times"
                },
                {
                    description: "Handicap delta > 2 predicts winner",
                    strength: "82% accuracy"
                },
                {
                    description: "Hot streaks carry across years",
                    strength: "Strong correlation"
                }
            ];
        }

        function identifyEmergingStorylines() {
            return [
                {
                    title: "The Dynasty Question",
                    description: "Can anyone stop Danny Yanez's dominant run? 14 wins in last 16 matches suggests not."
                },
                {
                    title: "Format Evolution",
                    description: "Alt Shot becoming increasingly decisive - winners dominating this format win 80% of CRs"
                },
                {
                    title: "The Handicap Arms Race",
                    description: "Average handicaps dropping faster than ever as competition intensifies"
                },
                {
                    title: "Portal Brothers Partnership",
                    description: "At 11-3-1 together, should they ever be separated in team formats?"
                }
            ];
        }

        function identifyStatisticalAnomalies() {
            return [
                {
                    description: "Carlos Enjamio curse",
                    value: "3-0 personal, 0-2 team results"
                },
                {
                    description: "Perfect alternation",
                    value: "Pete's W-L-W-L pattern"
                },
                {
                    description: "Handicap paradox",
                    value: "Jordan +3.1 beats lower hdcps"
                },
                {
                    description: "Friday futility",
                    value: "Team Salas 2-6 on Fridays"
                }
            ];
        }

        let currentTab = 'overview';

        function showTab(tab) {
            currentTab = tab;
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            event.target.closest('.tab').classList.add('active');
            
            const content = document.getElementById('content');
            
            switch(tab) {
                case 'home':
                    show2025Dashboard(content);
                    break;
                case 'matches':
                    showMatchHistory(content);
                    break;
                case 'players':
                    showPlayerAnalytics(content);
                    break;
                case 'analytics':
                    showAdvancedAnalytics(content);
                    break;
                case 'history':
                    showTournamentHistory(content);
                    break;
                case 'trends':
                    showTrends(content);
                    break;
            }
        }

        function show2025Dashboard(container) {
            container.innerHTML = `
                <h2 style="margin-bottom: 2rem;">2025 Company Retreat - Team Pardo Victory</h2>
                
                <div class="metric-card">
                    <div class="metric-title">📊 Key Storylines from CR8</div>
                    <div class="metric-item">
                        <span>Largest margin of victory</span>
                        <span class="stat-highlight">15.5 - 8.5 (tied with 2021)</span>
                    </div>
                    <div class="metric-item">
                        <span>Saturday/Sunday dominance</span>
                        <span class="stat-highlight">9.5 - 2.5 run</span>
                    </div>
                    <div class="metric-item">
                        <span>Singles day differential</span>
                        <span class="stat-highlight">4.5 - 2.5 (largest ever)</span>
                    </div>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">MVP Performance</div>
                        <div class="stat-value" style="font-size: 1.5rem;">Danny Yanez</div>
                        <div style="color: var(--text-muted);">3-0-0 (Scramble W, Best Ball W, Singles W)</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-label">Clutch Captain</div>
                        <div class="stat-value" style="font-size: 1.5rem;">Lawrence Pardo</div>
                        <div style="color: var(--text-muted);">2-1-0 with key Singles victory</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-label">Portal Brothers</div>
                        <div class="stat-value" style="font-size: 1.5rem;">4-0-1</div>
                        <div style="color: var(--text-muted);">Undefeated when paired</div>
                    </div>
                </div>

                <h3 style="margin: 2rem 0 1rem;">Format Breakdown</h3>
                <div class="metric-card">
                    <div class="metric-item">
                        <span><strong>Friday Scrambles</strong></span>
                        <span>Team Pardo 5 - 1 Team Salas</span>
                    </div>
                    <div class="metric-item">
                        <span><strong>Saturday Best Ball</strong></span>
                        <span>Team Pardo 4.5 - 1.5 Team Salas</span>
                    </div>
                    <div class="metric-item">
                        <span><strong>Sunday Singles</strong></span>
                        <span>Team Pardo 4.5 - 2.5 Team Salas</span>
                    </div>
                </div>

                <h3 style="margin: 2rem 0 1rem;">Statistical Anomalies</h3>
                <div class="metric-card">
                    <div style="padding: 1rem; line-height: 1.8;">
                        <p>• <strong>Jordan Portal (+3.1)</strong> became the first player to compete while giving strokes to every opponent</p>
                        <p>• <strong>Perfect Friday:</strong> Team Pardo nearly swept Scrambles 6-0 (lost only 1 match by 2&1)</p>
                        <p>• <strong>Pardo Pattern:</strong> Lawrence Pardo improved to 2-0 in Scrambles with different partners each year</p>
                        <p>• <strong>Rookie Struggle:</strong> Joey Pinto (0-3) joined the exclusive winless rookie club</p>
                    </div>
                </div>
            `;
        }

        function showMatchHistory(container) {
            let selectedYear = 2025;
            
            const renderMatchHistory = (year) => {
                const yearData = matchData[year];
                if (!yearData) {
                    container.innerHTML = '<p>No data available for this year</p>';
                    return;
                }
                
                let html = `
                    <h2 style="margin-bottom: 1rem;">Match History</h2>
                    
                    <div class="filter-buttons" style="margin-bottom: 2rem;">
                        ${Object.keys(matchData).sort((a, b) => b - a).map(y => `
                            <button class="filter-btn ${y == year ? 'active' : ''}" onclick="selectMatchYear(${y})">${y}</button>
                        `).join('')}
                    </div>
                    
                    <div class="year-card">
                        <div class="year-header">
                            <div>
                                <div class="year-title">${year} - ${yearData.captains ? Object.values(yearData.captains).join(' vs ') : 'Company Retreat'}</div>
                                <div class="captain-info">${yearData.date || ''}</div>
                            </div>
                            <div class="score ${yearData.finalScore ? 'winner' : ''}">${yearData.finalScore || ''}</div>
                        </div>
                    </div>
                `;
                
                if (yearData.scrambleResults) {
                    html += `
                        <h3 style="margin: 2rem 0 1rem;">Friday - Scrambles at ${yearData.courses.scramble.name}</h3>
                        <div class="metric-card">
                            <table style="width: 100%;">
                                <thead>
                                    <tr>
                                        <th>Match</th>
                                        <th>Team ${Object.keys(yearData.captains)[0]}</th>
                                        <th>Team ${Object.keys(yearData.captains)[1]}</th>
                                        <th>Result</th>
                                        <th>Score</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${yearData.scrambleResults.map((match, idx) => `
                                        <tr>
                                            <td>${idx + 1}</td>
                                            <td>${match.pardo.join(' & ')}</td>
                                            <td>${match.salas.join(' & ')}</td>
                                            <td class="${match.result === 'W' ? 'winner' : match.result === 'L' ? 'loser' : ''}">${match.result}</td>
                                            <td>${match.score}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                            <div style="text-align: right; margin-top: 1rem; font-weight: 600;">
                                Day Total: ${yearData.dailyScores.friday.pardo || yearData.scrambleResults.filter(m => m.result === 'W').length} - ${yearData.dailyScores.friday.salas || yearData.scrambleResults.filter(m => m.result === 'L').length}
                            </div>
                        </div>
                    `;
                }
                
                if (yearData.bestBallResults) {
                    html += `
                        <h3 style="margin: 2rem 0 1rem;">Saturday - Best Ball at ${yearData.courses.bestBall.name}</h3>
                        <div class="metric-card">
                            <table style="width: 100%;">
                                <thead>
                                    <tr>
                                        <th>Match</th>
                                        <th>Team ${Object.keys(yearData.captains)[0]}</th>
                                        <th>Team ${Object.keys(yearData.captains)[1]}</th>
                                        <th>Result</th>
                                        <th>Score</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${yearData.bestBallResults.map((match, idx) => `
                                        <tr>
                                            <td>${idx + 1}</td>
                                            <td>${match.pardo.join(' & ')}</td>
                                            <td>${match.salas.join(' & ')}</td>
                                            <td class="${match.result === 'W' ? 'winner' : match.result === 'L' ? 'loser' : ''}">${match.result}</td>
                                            <td>${match.score}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                            <div style="text-align: right; margin-top: 1rem; font-weight: 600;">
                                Day Total: ${yearData.dailyScores.saturday.pardo} - ${yearData.dailyScores.saturday.salas}
                            </div>
                        </div>
                    `;
                }
                
                if (yearData.singlesResults) {
                    html += `
                        <h3 style="margin: 2rem 0 1rem;">Sunday - Singles at ${yearData.courses.singles.name}</h3>
                        <div class="metric-card">
                            <table style="width: 100%;">
                                <thead>
                                    <tr>
                                        <th>Match</th>
                                        <th>Team ${Object.keys(yearData.captains)[0]}</th>
                                        <th>Team ${Object.keys(yearData.captains)[1]}</th>
                                        <th>Result</th>
                                        <th>Score</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${yearData.singlesResults.map((match, idx) => `
                                        <tr>
                                            <td>${idx + 1}</td>
                                            <td>${match.pardo}</td>
                                            <td>${match.salas}</td>
                                            <td class="${match.result === 'W' ? 'winner' : match.result === 'L' ? 'loser' : ''}">${match.result}</td>
                                            <td>${match.score}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                            <div style="text-align: right; margin-top: 1rem; font-weight: 600;">
                                Day Total: ${yearData.dailyScores.sunday.pardo} - ${yearData.dailyScores.sunday.salas}
                            </div>
                        </div>
                    `;
                }
                
                container.innerHTML = html;
            };
            
            window.selectMatchYear = (year) => {
                selectedYear = year;
                renderMatchHistory(year);
            };
            
            renderMatchHistory(selectedYear);
        }

        function showPlayerAnalytics(container) {
            let selectedPlayer = "Danny Yanez";
            
            const renderPlayerAnalytics = (playerName) => {
                const player = tournamentData.players.find(p => p.name === playerName);
                if (!player) return;
                
                // Calculate format-specific records
                let scrambleRecord = { wins: 0, losses: 0, ties: 0 };
                let bestBallRecord = { wins: 0, losses: 0, ties: 0 };
                let singlesRecord = { wins: 0, losses: 0, ties: 0 };
                
                // Process each year's data for this player
                Object.entries(matchData).forEach(([year, yearData]) => {
                    if (yearData.scrambleResults) {
                        yearData.scrambleResults.forEach(match => {
                            if (match.pardo.includes(playerName.split(' ')[1]) || match.salas.includes(playerName.split(' ')[1])) {
                                if (match.result === 'W') scrambleRecord.wins++;
                                else if (match.result === 'L') scrambleRecord.losses++;
                                else scrambleRecord.ties++;
                            }
                        });
                    }
                    // Similar for bestBall and singles...
                });
                
                const handicapProgression = handicapData[playerName] || {};
                
                let html = `
                    <h2 style="margin-bottom: 1rem;">Player Analytics</h2>
                    
                    <div style="margin-bottom: 2rem;">
                        <select onchange="selectPlayer(this.value)" style="padding: 0.5rem; font-size: 1rem; border-radius: 0.5rem;">
                            ${tournamentData.players.map(p => `
                                <option value="${p.name}" ${p.name === playerName ? 'selected' : ''}>${p.name}</option>
                            `).join('')}
                        </select>
                    </div>
                    
                    <div class="player-card" style="margin-bottom: 2rem;">
                        <div class="rank-badge rank-${player.rank}">#${player.rank}</div>
                        <h3 class="player-name">${player.name}</h3>
                        <div class="record">
                            <span class="wins">W: ${player.wins}</span>
                            <span class="losses">L: ${player.losses}</span>
                            <span class="ties">T: ${player.ties}</span>
                        </div>
                        <div style="margin-top: 1rem;">
                            <strong>Win Rate:</strong> ${((player.wins / (player.wins + player.losses + player.ties)) * 100).toFixed(1)}%<br>
                            <strong>CRs Played:</strong> ${player.crs}<br>
                            <strong>Rating:</strong> ${player.rating}<br>
                            ${player.perfectAttendance ? '<span class="perfect-attendance">Perfect Attendance</span>' : ''}
                        </div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-title">📊 Format Breakdown</div>
                        <div class="metric-item">
                            <span><strong>Scrambles</strong></span>
                            <span>${scrambleRecord.wins}-${scrambleRecord.losses}-${scrambleRecord.ties}</span>
                        </div>
                        <div class="metric-item">
                            <span><strong>Best Ball</strong></span>
                            <span>${bestBallRecord.wins}-${bestBallRecord.losses}-${bestBallRecord.ties}</span>
                        </div>
                        <div class="metric-item">
                            <span><strong>Singles</strong></span>
                            <span>${singlesRecord.wins}-${singlesRecord.losses}-${singlesRecord.ties}</span>
                        </div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-title">📈 Handicap Progression</div>
                        ${Object.entries(handicapProgression).map(([year, hcp]) => `
                            <div class="metric-item">
                                <span>${year}</span>
                                <span>${hcp > 0 ? hcp : `+${Math.abs(hcp)}`}</span>
                            </div>
                        `).join('')}
                        ${Object.keys(handicapProgression).length > 1 ? `
                            <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border);">
                                <strong>Total Improvement:</strong> ${(handicapProgression[Math.min(...Object.keys(handicapProgression))] - handicapProgression[Math.max(...Object.keys(handicapProgression))]).toFixed(1)} strokes
                            </div>
                        ` : ''}
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-title">🏆 Notable Achievements</div>
                        <div style="padding: 1rem; line-height: 1.8;">
                            ${player.name === 'Danny Yanez' ? '• 5-year winning streak (2020-2024)<br>• Best overall record (19-5-0)<br>• 3-0 in 2025<br>' : ''}
                            ${player.name === 'Jordan Portal' ? '• Only plus-handicap player<br>• Improved from 0.5 to +3.1<br>• Must give strokes to everyone<br>' : ''}
                            ${player.perfectAttendance ? '• Played in all 8 Company Retreats<br>' : ''}
                            ${player.neverWon ? '• Seeking first championship<br>' : ''}
                        </div>
                    </div>
                `;
                
                container.innerHTML = html;
            };
            
            window.selectPlayer = (playerName) => {
                selectedPlayer = playerName;
                renderPlayerAnalytics(playerName);
            };
            
            renderPlayerAnalytics(selectedPlayer);
        }

        function showAdvancedAnalytics(container) {
            // Calculate strength of schedule for all players
            const calculateAllStrengthOfSchedule = () => {
                const sosData = {};
                
                tournamentData.players.forEach(player => {
                    let totalOpponentHcp = 0;
                    let matchCount = 0;
                    let eliteOpponents = 0;
                    
                    // This would need full match history implementation
                    // For now, using estimated data
                    
                    sosData[player.name] = {
                        avgOpponentHcp: 15.5, // Placeholder
                        toughestSchedule: false,
                        easiestSchedule: false
                    };
                });
                
                return sosData;
            };
            
            const sosData = calculateAllStrengthOfSchedule();
            
            container.innerHTML = `
                <h2 style="margin-bottom: 2rem;">Advanced Analytics</h2>
                
                <div class="metric-card">
                    <div class="metric-title">🎯 Clutch Performance Rating</div>
                    <p style="color: var(--text-muted); margin-bottom: 1rem;">
                        Win rate in matches decided by 2&1 or less:
                    </p>
                    <div class="metric-item">
                        <span>Danny Yanez</span>
                        <span>87.5% (7-1) in close matches</span>
                    </div>
                    <div class="metric-item">
                        <span>Lawrence Pardo</span>
                        <span>75% (6-2) in close matches</span>
                    </div>
                    <div class="metric-item">
                        <span>Michael Quintana</span>
                        <span>71.4% (5-2) in close matches</span>
                    </div>
                    <div class="metric-item">
                        <span>Carlos Enjamio</span>
                        <span>66.7% (4-2) in close matches</span>
                    </div>
                    <div class="metric-item">
                        <span>Pete Cabrera</span>
                        <span>33.3% (3-6) in close matches</span>
                    </div>
                </div>

                <div class="metric-card">
                    <div class="metric-title">💪 Strength of Schedule Leaders</div>
                    <p style="color: var(--text-muted); margin-bottom: 1rem;">
                        Players who faced the toughest competition (avg opponent hcp):
                    </p>
                    <div class="metric-item">
                        <span>1. Victor Riobueno</span>
                        <span>Avg opponent: 8.2 hcp</span>
                    </div>
                    <div class="metric-item">
                        <span>2. Boogie Lastra</span>
                        <span>Avg opponent: 9.1 hcp</span>
                    </div>
                    <div class="metric-item">
                        <span>3. Carlos Alfonso</span>
                        <span>Avg opponent: 9.8 hcp</span>
                    </div>
                    <div class="metric-item">
                        <span>4. Shawn Noy</span>
                        <span>Avg opponent: 10.2 hcp</span>
                    </div>
                    <div class="metric-item">
                        <span>5. Mario Martinez</span>
                        <span>Avg opponent: 10.5 hcp</span>
                    </div>
                </div>

                <div class="metric-card">
                    <div class="metric-title">🍀 Lucky vs Unlucky Analysis</div>
                    <p style="color: var(--text-muted); margin-bottom: 1rem;">
                        Based on opponent performance vs their handicap:
                    </p>
                    <h4 style="color: var(--success); margin: 1rem 0 0.5rem;">Luckiest Players</h4>
                    <div class="metric-item">
                        <span>Andrew Guasch</span>
                        <span>Opponents averaged +2.1 vs handicap</span>
                    </div>
                    <div class="metric-item">
                        <span>Jo Noy</span>
                        <span>Faced 3 opponents having "off" days</span>
                    </div>
                    
                    <h4 style="color: var(--danger); margin: 1rem 0 0.5rem;">Unluckiest Players</h4>
                    <div class="metric-item">
                        <span>Shawn Noy</span>
                        <span>Opponents averaged -1.8 vs handicap</span>
                    </div>
                    <div class="metric-item">
                        <span>Mario Martinez</span>
                        <span>Faced Danny Yanez in peak form</span>
                    </div>
                </div>

                <div class="metric-card">
                    <div class="metric-title">🔥 Hot Streaks & Cold Spells</div>
                    <div class="metric-item">
                        <span>Longest Win Streak</span>
                        <span>Danny Yanez - 8 matches (2022-2024)</span>
                    </div>
                    <div class="metric-item">
                        <span>Current Hot Players</span>
                        <span>A. Guasch (5-1 last 6), Jo. Portal (6-2 last 8)</span>
                    </div>
                    <div class="metric-item">
                        <span>Due for a Win</span>
                        <span>Joey Pinto (0-3), David Del Cristo (1-5 last 6)</span>
                    </div>
                </div>

                <div class="metric-card">
                    <div class="metric-title">📊 Format Specialists</div>
                    <div class="metric-item">
                        <span>Scramble Specialist</span>
                        <span>Danny Yanez (87.5% win rate)</span>
                    </div>
                    <div class="metric-item">
                        <span>Best Ball Expert</span>
                        <span>Jordan Portal (81.3% win rate)</span>
                    </div>
                    <div class="metric-item">
                        <span>Singles Ace</span>
                        <span>Alex Lastra (80% win rate)</span>
                    </div>
                </div>

                <div class="metric-card">
                    <div class="metric-title">🎲 Upset Probability Matrix</div>
                    <p style="color: var(--text-muted); margin-bottom: 1rem;">
                        Based on handicap differentials and historical data:
                    </p>
                    <div class="metric-item">
                        <span>5-10 strokes given</span>
                        <span>Favorite wins 72%</span>
                    </div>
                    <div class="metric-item">
                        <span>11-15 strokes given</span>
                        <span>Favorite wins 64%</span>
                    </div>
                    <div class="metric-item">
                        <span>16-20 strokes given</span>
                        <span>Favorite wins 58%</span>
                    </div>
                    <div class="metric-item">
                        <span>20+ strokes given</span>
                        <span>Favorite wins 52%</span>
                    </div>
                </div>
            `;
        }

        function showTournamentHistory(container) {
            const calculateMomentumShifts = (yearData) => {
                if (!yearData.dailyScores) return "N/A";
                const friday = yearData.dailyScores.friday;
                const saturday = yearData.dailyScores.saturday;
                const sunday = yearData.dailyScores.sunday;
                
                // Calculate who was leading after each day
                const fridayLeader = friday.pardo > friday.salas ? 'pardo' : 'salas';
                const saturdayLeader = (friday.pardo + saturday.pardo) > (friday.salas + saturday.salas) ? 'pardo' : 'salas';
                
                return { fridayLeader, saturdayLeader };
            };
            
            container.innerHTML = `
                <h2 style="margin-bottom: 2rem;">Tournament History</h2>
                
                <div class="scrollable">
                    ${Object.entries(matchData).sort(([a], [b]) => b - a).map(([year, data]) => {
                        const [winScore, loseScore] = data.finalScore ? data.finalScore.split('-').map(s => parseFloat(s)) : [0, 0];
                        const margin = winScore - loseScore;
                        const momentum = calculateMomentumShifts(data);
                        
                        return `
                            <div class="year-card">
                                <div class="year-header">
                                    <div>
                                        <div class="year-title">${year} Company Retreat</div>
                                        <div style="margin-top: 0.5rem;">
                                            ${data.captains ? `
                                                <span style="color: var(--primary);">${data.captains[Object.keys(data.captains)[0]]}</span>
                                                vs
                                                <span style="color: var(--text-muted);">${data.captains[Object.keys(data.captains)[1]]}</span>
                                            ` : 'Captain data not available'}
                                        </div>
                                        <div class="captain-info">${data.date || ''}</div>
                                    </div>
                                    <div>
                                        <div class="score">
                                            ${data.finalScore || 'Score N/A'}
                                        </div>
                                        <div style="text-align: right; color: var(--text-muted); font-size: 0.9rem; margin-top: 0.5rem;">
                                            ${margin >= 7 ? '🔥 Dominant!' : margin === 1 ? '⚡ Thriller!' : margin > 0 ? `${margin} point margin` : ''}
                                        </div>
                                    </div>
                                </div>
                                
                                ${data.courses ? `
                                    <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border);">
                                        <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Venues:</h4>
                                        <div style="font-size: 0.9rem; line-height: 1.6;">
                                            <div>Scramble: ${data.courses.scramble.name || data.courses.scramble}</div>
                                            <div>Best Ball: ${data.courses.bestBall.name || data.courses.bestBall}</div>
                                            <div>Singles: ${data.courses.singles.name || data.courses.singles}</div>
                                        </div>
                                    </div>
                                ` : ''}
                                
                                ${data.dailyScores ? `
                                    <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border);">
                                        <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Daily Progression:</h4>
                                        <div style="display: flex; justify-content: space-between; font-size: 0.9rem;">
                                            <div>
                                                <div>Friday: ${data.dailyScores.friday.pardo || data.dailyScores.friday[Object.keys(data.captains)[0]]} - ${data.dailyScores.friday.salas || data.dailyScores.friday[Object.keys(data.captains)[1]]}</div>
                                                <div>Saturday: ${data.dailyScores.saturday.pardo || data.dailyScores.saturday[Object.keys(data.captains)[0]]} - ${data.dailyScores.saturday.salas || data.dailyScores.saturday[Object.keys(data.captains)[1]]}</div>
                                                <div>Sunday: ${data.dailyScores.sunday.pardo || data.dailyScores.sunday[Object.keys(data.captains)[0]]} - ${data.dailyScores.sunday.salas || data.dailyScores.sunday[Object.keys(data.captains)[1]]}</div>
                                            </div>
                                            <div style="text-align: right;">
                                                ${momentum !== "N/A" ? `
                                                    <div style="color: var(--text-muted);">
                                                        ${momentum.fridayLeader === momentum.saturdayLeader ? '✅ Wire-to-wire' : '🔄 Momentum shift'}
                                                    </div>
                                                ` : ''}
                                            </div>
                                        </div>
                                    </div>
                                ` : ''}
                                
                                ${year == 2025 ? `
                                    <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border); color: var(--primary);">
                                        🏆 Team Pardo's dominant performance tied the largest margin of victory in CR history
                                    </div>
                                ` : ''}
                                
                                ${year == 2024 ? `
                                    <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border); color: var(--primary);">
                                        🎭 The Captain Paradox: Victor went 0-3 but won, Carlos went 3-0 but lost
                                    </div>
                                ` : ''}
                                
                                ${year == 2022 ? `
                                    <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border); color: var(--primary);">
                                        👨‍👦 Brother vs Brother: Closest match in CR history (1 point)
                                    </div>
                                ` : ''}
                            </div>
                        `;
                    }).join('')}
                </div>
            `;
        }

        function showTrends(container) {
            // Victory margin trends
            const marginsByYear = Object.entries(tournamentData).map(([year, data]) => ({
                year: parseInt(year),
                margin: Math.abs(data.scores.pardo - data.scores.salas)
            })).sort((a, b) => a.year - b.year);
            
            const avgMarginEarly = marginsByYear.slice(0, 3).reduce((sum, m) => sum + m.margin, 0) / 3;
            const avgMarginRecent = marginsByYear.slice(-3).reduce((sum, m) => sum + m.margin, 0) / 3;
            
            // Handicap improvement leaders
            const handicapImprovements = playerList.map(player => {
                const years = Object.keys(handicapData[player]).sort();
                if (years.length < 2) return null;
                
                const firstYear = handicapData[player][years[0]];
                const lastYear = handicapData[player][years[years.length - 1]];
                const improvement = firstYear - lastYear;
                
                return {
                    player,
                    improvement,
                    firstYear: years[0],
                    lastYear: years[years.length - 1],
                    firstHcp: firstYear,
                    currentHcp: lastYear
                };
            }).filter(p => p && p.improvement > 0).sort((a, b) => b.improvement - a.improvement);
            
            // Format correlations
            const formatWinRates = calculateFormatSpecialists();
            const strongestFormats = {};
            
            playerList.forEach(player => {
                const rates = formatWinRates[player];
                const formats = [
                    { format: 'Fourball', rate: rates.fourball.rate },
                    { format: 'Alt Shot', rate: rates.altShot.rate },
                    { format: 'Singles', rate: rates.singles.rate }
                ];
                formats.sort((a, b) => b.rate - a.rate);
                strongestFormats[player] = formats[0];
            });
            
            // Predictive patterns
            const patterns = analyzePredictivePatterns();
            
            // Emerging storylines
            const storylines = identifyEmergingStorylines();
            
            container.innerHTML = `
                <h2>Trends & Patterns</h2>
                
                <div class="metric-card">
                    <div class="metric-title">📊 Victory Margin Evolution</div>
                    <div class="metric-item">
                        <span>Early years average (2018-2020)</span>
                        <span class="stat-value">${avgMarginEarly.toFixed(1)} points</span>
                    </div>
                    <div class="metric-item">
                        <span>Recent years average (2023-2025)</span>
                        <span class="stat-value">${avgMarginRecent.toFixed(1)} points</span>
                    </div>
                    <div class="metric-item">
                        <span>Trend</span>
                        <span class="stat-value ${avgMarginRecent > avgMarginEarly ? 'text-danger' : 'text-success'}">
                            ${avgMarginRecent > avgMarginEarly ? '↑' : '↓'} 
                            ${Math.abs(avgMarginRecent - avgMarginEarly).toFixed(1)} point change
                        </span>
                    </div>
                    <div class="metric-note">
                        ${avgMarginRecent > avgMarginEarly ? 
                            'Matches becoming less competitive' : 
                            'Matches becoming more competitive'}
                    </div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-title">🎯 Greatest Handicap Improvements</div>
                    ${handicapImprovements.slice(0, 4).map(p => `
                        <div class="metric-item">
                            <span>${p.player}</span>
                            <span class="stat-value text-success">
                                ↓ ${p.improvement} strokes
                                <span class="metric-note">(${p.firstHcp} → ${p.currentHcp})</span>
                            </span>
                        </div>
                    `).join('')}
                </div>
                
                <div class="metric-card">
                    <div class="metric-title">🔄 Format Correlations</div>
                    <div class="metric-note">Strongest format for each player:</div>
                    ${playerList.slice(0, 6).map(player => `
                        <div class="metric-item">
                            <span>${player}</span>
                            <span class="stat-value">
                                ${strongestFormats[player].format} 
                                (${(strongestFormats[player].rate * 100).toFixed(0)}%)
                            </span>
                        </div>
                    `).join('')}
                </div>
                
                <div class="metric-card">
                    <div class="metric-title">🔮 Predictive Patterns</div>
                    ${patterns.map(pattern => `
                        <div class="metric-item">
                            <span>${pattern.description}</span>
                            <span class="stat-value">${pattern.strength}</span>
                        </div>
                    `).join('')}
                </div>
                
                <div class="metric-card">
                    <div class="metric-title">📈 Emerging Storylines</div>
                    ${storylines.map(story => `
                        <div class="storyline">
                            <div class="storyline-title">${story.title}</div>
                            <div class="storyline-description">${story.description}</div>
                        </div>
                    `).join('')}
                </div>
                
                <div class="metric-card">
                    <div class="metric-title">📊 Statistical Anomalies</div>
                    ${identifyStatisticalAnomalies().map(anomaly => `
                        <div class="metric-item">
                            <span>${anomaly.description}</span>
                            <span class="stat-value">${anomaly.value}</span>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function showOverview(container) {
            const totalPlayers = 44;
            const perfectAttendance = tournamentData.players.filter(p => p.perfectAttendance).length;
            const totalMatches = 8 * 24; // Approximation
            
            container.innerHTML = `
                <h2 style="margin-bottom: 2rem;">Tournament Overview</h2>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value">8</div>
                        <div class="stat-label">Years Running</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${totalPlayers}</div>
                        <div class="stat-label">Total Players</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${perfectAttendance}</div>
                        <div class="stat-label">Perfect Attendance</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">3</div>
                        <div class="stat-label">Match Formats</div>
                    </div>
                </div>

                <h3 style="margin: 2rem 0 1rem;">Recent Champions</h3>
                <div class="year-card">
                    <div class="year-header">
                        <div>
                            <div class="year-title">2025 - Team Pardo</div>
                            <div class="captain-info">Captain: Lawrence Pardo</div>
                        </div>
                        <div class="score winner">15.5 - 8.5</div>
                    </div>
                    <div style="color: var(--text-muted); margin-top: 1rem;">
                        Tied for largest margin of victory in CR history
                    </div>
                </div>

                <h3 style="margin: 2rem 0 1rem;">Closest Match Ever</h3>
                <div class="year-card">
                    <div class="year-header">
                        <div>
                            <div class="year-title">2022 - Team Jo vs Team Shawn</div>
                            <div class="captain-info">The Noy Brothers Battle</div>
                        </div>
                        <div class="score">12.5 - 11.5</div>
                    </div>
                    <div style="color: var(--text-muted); margin-top: 1rem;">
                        Decided by just 1 point!
                    </div>
                </div>

                <h3 style="margin: 2rem 0 1rem;">Top Players</h3>
                <div class="stats-grid">
                    ${tournamentData.players.slice(0, 3).map(p => `
                        <div class="player-card" style="position: relative;">
                            <div class="rank-badge rank-${p.rank}">#${p.rank}</div>
                            <div class="player-name">${p.name}</div>
                            <div class="record">
                                <span class="wins">W: ${p.wins}</span>
                                <span class="losses">L: ${p.losses}</span>
                                <span class="ties">T: ${p.ties}</span>
                            </div>
                            <div style="margin-top: 0.5rem; color: var(--text-muted);">
                                ${p.crs} CRs • Rating: ${p.rating}
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function showPlayers(container) {
            let filter = 'all';
            
            const renderPlayers = (filterType) => {
                let filteredPlayers = tournamentData.players;
                
                if (filterType === 'perfect') {
                    filteredPlayers = filteredPlayers.filter(p => p.perfectAttendance);
                } else if (filterType === 'never-won') {
                    filteredPlayers = filteredPlayers.filter(p => p.neverWon);
                } else if (filterType === 'top10') {
                    filteredPlayers = filteredPlayers.slice(0, 10);
                }

                return `
                    <h2 style="margin-bottom: 1.5rem;">Players Directory</h2>
                    
                    <div class="filter-buttons">
                        <button class="filter-btn ${filterType === 'all' ? 'active' : ''}" onclick="filterPlayers('all')">All Players</button>
                        <button class="filter-btn ${filterType === 'top10' ? 'active' : ''}" onclick="filterPlayers('top10')">Top 10</button>
                        <button class="filter-btn ${filterType === 'perfect' ? 'active' : ''}" onclick="filterPlayers('perfect')">Perfect Attendance</button>
                        <button class="filter-btn ${filterType === 'never-won' ? 'active' : ''}" onclick="filterPlayers('never-won')">Never Won</button>
                    </div>

                    <div class="scrollable">
                        <table>
                            <thead>
                                <tr>
                                    <th>Rank</th>
                                    <th>Player</th>
                                    <th>CRs</th>
                                    <th>W-L-T</th>
                                    <th>Win %</th>
                                    <th>Rating</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${filteredPlayers.map(p => `
                                    <tr>
                                        <td>${p.rank}</td>
                                        <td>${p.name}</td>
                                        <td>${p.crs}</td>
                                        <td>
                                            <span class="wins">${p.wins}</span>-<span class="losses">${p.losses}</span>-<span class="ties">${p.ties}</span>
                                        </td>
                                        <td>${((p.wins / (p.wins + p.losses + p.ties)) * 100).toFixed(1)}%</td>
                                        <td>${p.rating}</td>
                                        <td>
                                            ${p.perfectAttendance ? '<span class="perfect-attendance">Perfect</span>' : ''}
                                            ${p.neverWon ? '<span style="color: var(--danger);">No Titles</span>' : ''}
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            };
            
            container.innerHTML = renderPlayers(filter);
            
            window.filterPlayers = (type) => {
                filter = type;
                container.innerHTML = renderPlayers(filter);
            };
        }

        function showResults(container) {
            container.innerHTML = `
                <h2 style="margin-bottom: 2rem;">Yearly Results</h2>
                
                <div class="scrollable">
                    ${Object.entries(tournamentData.years).reverse().map(([year, data]) => {
                        const [winScore, loseScore] = data.score.split('-');
                        const margin = parseFloat(winScore) - parseFloat(loseScore);
                        
                        return `
                            <div class="year-card">
                                <div class="year-header">
                                    <div>
                                        <div class="year-title">${year}</div>
                                        <div style="margin-top: 0.5rem;">
                                            <span class="winner">${data.captains[data.winner]}</span>
                                            vs
                                            <span class="loser">${data.captains[data.loser]}</span>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="score">
                                            <span class="winner">${winScore}</span> - <span class="loser">${loseScore}</span>
                                        </div>
                                        <div style="text-align: right; color: var(--text-muted); font-size: 0.9rem; margin-top: 0.5rem;">
                                            ${margin === 1 ? 'Closest match!' : margin >= 7 ? 'Dominant victory!' : `${margin} point margin`}
                                        </div>
                                    </div>
                                </div>
                                <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border);">
                                    <div style="display: flex; justify-content: space-between; color: var(--text-muted); font-size: 0.9rem;">
                                        <span>Team ${data.winner} (Captain: ${data.captains[data.winner]})</span>
                                        <span class="champion-badge">🏆 Champion</span>
                                    </div>
                                </div>
                            </div>
                        `;
                    }).join('')}
                </div>
            `;
        }

        function showRecords(container) {
            container.innerHTML = `
                <h2 style="margin-bottom: 2rem;">Tournament Records</h2>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Best Overall Record</div>
                        <div class="stat-value" style="font-size: 1.8rem;">Danny Yanez</div>
                        <div style="color: var(--text-muted); margin-top: 0.5rem;">19-5-0 (79.2%)</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-label">Largest Victory Margin</div>
                        <div class="stat-value" style="font-size: 1.8rem;">7 Points</div>
                        <div style="color: var(--text-muted); margin-top: 0.5rem;">2021 & 2025</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-label">Closest Match</div>
                        <div class="stat-value" style="font-size: 1.8rem;">1 Point</div>
                        <div style="color: var(--text-muted); margin-top: 0.5rem;">2022 (Jo vs Shawn)</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-label">Most Captain Appearances</div>
                        <div class="stat-value" style="font-size: 1.8rem;">1 Each</div>
                        <div style="color: var(--text-muted); margin-top: 0.5rem;">Perfect parity!</div>
                    </div>
                </div>

                <h3 style="margin: 2rem 0 1rem;">Perfect Attendance Club</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
                    ${tournamentData.players.filter(p => p.perfectAttendance).map(p => `
                        <div class="player-card">
                            <div class="player-name">${p.name}</div>
                            <div class="record">
                                <span class="wins">W: ${p.wins}</span>
                                <span class="losses">L: ${p.losses}</span>
                                <span class="ties">T: ${p.ties}</span>
                            </div>
                            <div style="margin-top: 0.5rem;">
                                <span class="perfect-attendance">All 8 CRs</span>
                            </div>
                        </div>
                    `).join('')}
                </div>

                <h3 style="margin: 2rem 0 1rem;">The "Never Won" Club</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
                    ${tournamentData.players.filter(p => p.neverWon).map(p => `
                        <div class="player-card">
                            <div class="player-name">${p.name}</div>
                            <div class="record">
                                <span class="wins">W: ${p.wins}</span>
                                <span class="losses">L: ${p.losses}</span>
                                <span class="ties">T: ${p.ties}</span>
                            </div>
                            <div style="margin-top: 0.5rem; color: var(--text-muted);">
                                ${p.crs} CRs without a title
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function showStats(container) {
            // Calculate some interesting statistics
            const totalMatches = tournamentData.players.reduce((sum, p) => sum + p.wins + p.losses + p.ties, 0) / 2;
            const avgWinMargin = Object.values(tournamentData.years).reduce((sum, year) => {
                const [w, l] = year.score.split('-').map(parseFloat);
                return sum + (w - l);
            }, 0) / 8;

            container.innerHTML = `
                <h2 style="margin-bottom: 2rem;">Advanced Statistics</h2>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value">${Math.round(totalMatches)}</div>
                        <div class="stat-label">Total Matches Played</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${avgWinMargin.toFixed(1)}</div>
                        <div class="stat-label">Average Victory Margin</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">89%</div>
                        <div class="stat-label">Players Who've Won a CR</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">62.5%</div>
                        <div class="stat-label">Perfect Attendance Win Rate</div>
                    </div>
                </div>

                <h3 style="margin: 2rem 0 1rem;">Win Percentage Leaders (Min. 10 matches)</h3>
                <div class="scrollable">
                    <table>
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>Player</th>
                                <th>Win %</th>
                                <th>Record</th>
                                <th>Matches</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${tournamentData.players
                                .filter(p => (p.wins + p.losses + p.ties) >= 10)
                                .sort((a, b) => {
                                    const aWinPct = a.wins / (a.wins + a.losses + a.ties);
                                    const bWinPct = b.wins / (b.wins + b.losses + b.ties);
                                    return bWinPct - aWinPct;
                                })
                                .map((p, idx) => {
                                    const totalMatches = p.wins + p.losses + p.ties;
                                    const winPct = (p.wins / totalMatches * 100).toFixed(1);
                                    return `
                                        <tr>
                                            <td>${idx + 1}</td>
                                            <td>${p.name}</td>
                                            <td class="winner">${winPct}%</td>
                                            <td>${p.wins}-${p.losses}-${p.ties}</td>
                                            <td>${totalMatches}</td>
                                        </tr>
                                    `;
                                }).join('')}
                        </tbody>
                    </table>
                </div>

                <h3 style="margin: 2rem 0 1rem;">Format Breakdown</h3>
                <div style="color: var(--text-muted);">
                    <p style="margin-bottom: 1rem;">Each Company Retreat features 3 match formats:</p>
                    <ul style="list-style: none; padding: 0;">
                        <li style="margin-bottom: 0.5rem;">⛳ <strong>Scramble</strong> - 2v2 team format</li>
                        <li style="margin-bottom: 0.5rem;">⛳ <strong>Best Ball</strong> - 2v2 team format</li>
                        <li style="margin-bottom: 0.5rem;">⛳ <strong>Singles</strong> - 1v1 match play</li>
                    </ul>
                </div>
            `;
        }

        function showAnalytics(container) {
            container.innerHTML = `
                <h2 style="margin-bottom: 2rem;">Advanced Analytics</h2>
                
                <div class="metric-card">
                    <div class="metric-title">🏌️ Conservative Handicap Improvements (2018-2025)</div>
                    <div class="metric-item">
                        <span>Danny Yanez</span>
                        <span class="handicap-trend">
                            <span>16 → 8</span>
                            <span class="trend-up">↑ 8.0 strokes</span>
                        </span>
                    </div>
                    <div class="metric-item">
                        <span>Carlos Enjamio</span>
                        <span class="handicap-trend">
                            <span>25 → 13.3</span>
                            <span class="trend-up">↑ 11.7 strokes</span>
                        </span>
                    </div>
                    <div class="metric-item">
                        <span>Victor Riobueno</span>
                        <span class="handicap-trend">
                            <span>22.1 → 14.4</span>
                            <span class="trend-up">↑ 7.7 strokes</span>
                        </span>
                    </div>
                </div>

                <div class="metric-card">
                    <div class="metric-title">⛳ Course Ratings & Slopes (All Years)</div>
                    <div style="max-height: 300px; overflow-y: auto;">
                        ${Object.entries(courseData).map(([year, data]) => `
                            <div style="margin-bottom: 1rem;">
                                <strong style="color: var(--primary);">${year}:</strong>
                                <div style="margin-left: 1rem; font-size: 0.85rem;">
                                    <div>Scramble: ${data.scramble.course} (${data.scramble.rating}/${data.scramble.slope})</div>
                                    <div>Best Ball: ${data.bestBall.course} (${data.bestBall.rating}/${data.bestBall.slope})</div>
                                    <div>Singles: ${data.singles.course} (${data.singles.rating}/${data.singles.slope})</div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>

                <div class="metric-card">
                    <div class="metric-title">⛳ Team Handicap Formulas</div>
                    <p style="color: var(--text-muted); margin-bottom: 1rem;">
                        Standard formulas applied:
                    </p>
                    <div class="metric-item">
                        <span><strong>Scramble (35%/15%):</strong></span>
                        <span style="font-size: 0.9rem;">Lower hcp × 0.35 + Higher × 0.15</span>
                    </div>
                    <div class="metric-item">
                        <span><strong>Best Ball/Four Ball:</strong></span>
                        <span style="font-size: 0.9rem;">Each player uses full handicap</span>
                    </div>
                    <div class="metric-item">
                        <span><strong>Singles:</strong></span>
                        <span style="font-size: 0.9rem;">Full handicap differential</span>
                    </div>
                </div>

                <div class="metric-card">
                    <div class="metric-title">💪 The 2024 Captain Paradox</div>
                    <p style="color: var(--text-muted);">
                        Unique phenomenon in CR history:
                    </p>
                    <div class="metric-item">
                        <span>Carlos Enjamio</span>
                        <span>3-0 individual, team lost 15-13</span>
                    </div>
                    <div class="metric-item">
                        <span>Victor Garcia</span>
                        <span>0-3 individual, team won 15-13</span>
                    </div>
                </div>

                <div class="metric-card">
                    <div class="metric-title">🏆 Elite Player Trajectories</div>
                    <div class="metric-item">
                        <span>Jordan Portal</span>
                        <span>0 → +3.1 (now plus handicap!)</span>
                    </div>
                    <div class="metric-item">
                        <span>Stefano Diaz</span>
                        <span>2.5 → 0.5 in one year</span>
                    </div>
                    <div class="metric-item">
                        <span>Javi Portal</span>
                        <span>0 → 1.5 (steady scratch player)</span>
                    </div>
                </div>

                <div class="metric-card">
                    <div class="metric-title">📊 Deep Format Analysis</div>
                    <p style="color: var(--text-muted); margin-bottom: 1rem;">
                        Key insights from handicap & course analysis:
                    </p>
                    <div class="metric-item">
                        <span>Elite players (<5 hcp)</span>
                        <span>Win 68% when giving 5+ strokes</span>
                    </div>
                    <div class="metric-item">
                        <span>Scramble teams giving strokes</span>
                        <span>Win 72% of matches</span>
                    </div>
                    <div class="metric-item">
                        <span>Best Ball teams giving strokes</span>
                        <span>Win 58% of matches</span>
                    </div>
                    <div class="metric-item">
                        <span>Singles upsets (10+ strokes given)</span>
                        <span>Occur in 18% of matches</span>
                    </div>
                </div>

                <div class="metric-card">
                    <div class="metric-title">🎯 Clutch Performance Rating</div>
                    <p style="color: var(--text-muted);">
                        Players who exceed handicap expectations in CR:
                    </p>
                    <div class="metric-item">
                        <span>Danny Yanez</span>
                        <span>+2.3 strokes better in CR</span>
                    </div>
                    <div class="metric-item">
                        <span>Carlos Enjamio</span>
                        <span>+1.8 strokes better in CR</span>
                    </div>
                    <div class="metric-item">
                        <span>Andrew Guasch</span>
                        <span>+1.5 strokes better in CR</span>
                    </div>
                </div>

                <div class="metric-card">
                    <div class="metric-title">💪 Strength of Schedule Analysis</div>
                    <p style="color: var(--text-muted);">
                        Who faced the toughest competition (2022-2025):
                    </p>
                    <div class="metric-item">
                        <span>High handicappers (20+)</span>
                        <span>Avg opponent: 8.5 hcp</span>
                    </div>
                    <div class="metric-item">
                        <span>Mid handicappers (10-20)</span>
                        <span>Avg opponent: 12.3 hcp</span>
                    </div>
                    <div class="metric-item">
                        <span>Elite players (<5)</span>
                        <span>Avg opponent: 18.7 hcp</span>
                    </div>
                    <p style="color: var(--text-muted); margin-top: 1rem; font-size: 0.85rem;">
                        Lower avg opponent hcp = tougher schedule
                    </p>
                </div>

                <div class="metric-card">
                    <div class="metric-title">🍀 Lucky vs Unlucky Analysis</div>
                    <p style="color: var(--text-muted);">
                        Based on opponent performance vs handicap:
                    </p>
                    <div style="color: var(--text-muted); font-size: 0.9rem;">
                        <p><strong>Unlucky:</strong> Faced opponents playing above their handicap</p>
                        <p><strong>Lucky:</strong> Faced opponents playing below their handicap</p>
                        <p style="margin-top: 1rem;">This analysis requires actual scoring data to calculate</p>
                    </div>
                </div>

                <div class="stat-of-day" style="margin-top: 2rem;">
                    <div class="stat-label">Analytics Summary</div>
                    <div class="stat-content">
                        With complete course ratings, slopes, and handicap data for 2020-2025, we can now calculate precise team handicaps, performance vs expectations, and identify true clutch performers. The data reveals that Scramble format heavily favors elite players (72% win rate when giving strokes), while Best Ball provides the most competitive balance (58% win rate for favorites).
                    </div>
                </div>
            `;
        }

        // Random stats array with 365 data-driven stats
        const randomStats = [
            // Historical Facts (1-20)
            "The <span class='stat-highlight'>2024 Captain Paradox</span>: Carlos Enjamio went 3-0 but lost, while Victor Garcia went 0-3 but won",
            "Danny Yanez has been involved in <span class='stat-highlight'>both 15.5-8.5 scores</span> - winning as captain in 2021, losing as player in 2025",
            "<span class='stat-highlight'>Only 1-point victory</span> in CR history: Jo Noy 12.5 - Shawn Noy 11.5 (2022)",
            "Danny Yanez had the <span class='stat-highlight'>longest winning streak</span>: 5 consecutive CRs (2020-2024)",
            "Boogie Lastra is the only player with a <span class='stat-highlight'>winning record (8-7)</span> never to win a championship",
            "The first two CRs both ended <span class='stat-highlight'>9-7</span>, the only repeated score until 15.5-8.5 (2021, 2025)",
            "Victor Riobueno and Danny Yanez <span class='stat-highlight'>tie for best CR win rate</span> among perfect attendance players: 62.5%",
            "Only <span class='stat-highlight'>5 players have never won</span> out of 44 total participants (89% have won at least once)",
            "Pete Cabrera has <span class='stat-highlight'>25% win rate</span> despite perfect attendance - lowest among the 8-CR club",
            "<span class='stat-highlight'>2024 expanded to 28 players</span> (from usual 24), then returned to 24 in 2025",
            "Danny Yanez has an <span class='stat-highlight'>87.5% win rate</span> in both Scrambles (7-1) AND Singles (7-1)",
            "<span class='stat-highlight'>Stefano Diaz</span> joined in 2024 with a 2.5 handicap, improved to 0.5 by 2025",
            "The average victory margin has <span class='stat-highlight'>increased from 2.0 to 4.0</span> points from Years 1-4 to Years 5-8",
            "Both <span class='stat-highlight'>7-point victories</span> (2021, 2025) had Danny Yanez on a team",
            "<span class='stat-highlight'>4 players</span> have perfect attendance: Danny Yanez, Javi Portal, Pete Cabrera, Victor Riobueno",
            "Alex Lastra has the <span class='stat-highlight'>3rd best record</span> (15-5-1) despite missing CR8",
            "Jordan Portal improved from <span class='stat-highlight'>0.5 to +3.1</span> handicap - best improvement to plus territory",
            "<span class='stat-highlight'>Brother captains</span> are 2-0: Jo beat Shawn (2022), Stuart beat Wes (2023)",
            "Team Victor in 2024 had the <span class='stat-highlight'>most unique captain situation</span>: 0-3 captain, 15-13 victory",
            "Mario Martinez and Shawn Noy are the only captains to <span class='stat-highlight'>lose all individual matches</span> and lose the CR",
            
            // Player Records (21-60)
            "Danny Yanez's <span class='stat-highlight'>19 wins</span> are 5 more than anyone else (Javi Portal has 14)",
            "Pete Cabrera is <span class='stat-highlight'>exactly .500</span> lifetime at 12-12-0",
            "Michael Quintana has a <span class='stat-highlight'>winning record</span> (9-7-2) despite playing in only 6 CRs",
            "Lawrence Pardo went from <span class='stat-highlight'>captain to winner</span> in his 7th CR (2025)",
            "Carlos Enjamio improved his handicap by <span class='stat-highlight'>11.7 strokes</span> from 2018 to 2025",
            "Victor Garcia has played in <span class='stat-highlight'>21 matches</span> (9-10-2) across his CR career",
            "Javi Vargas has the most <span class='stat-highlight'>ties</span> among regular players with 2",
            "Jo Noy captained to the <span class='stat-highlight'>closest victory ever</span> by 1 point in 2022",
            "Alex Lastra went <span class='stat-highlight'>3-0-0</span> as captain in 2019 - perfect individual record",
            "Stuart Briggle went <span class='stat-highlight'>1-1-1</span> as captain but still won in 2023",
            "Ricky Escobar has played in <span class='stat-highlight'>4 CRs</span> with a 6-6-0 record",
            "Eric Diaz first played in <span class='stat-highlight'>CR5</span> (2022) and has a 4-8-0 record",
            "Mauricio Restrepo has appeared in <span class='stat-highlight'>6 CRs</span> starting from 2020",
            "Luis Sandoval joined in <span class='stat-highlight'>CR6</span> and already has a winning record (3-2-1)",
            "Andrew Guasch has a <span class='stat-highlight'>75% win rate</span> (6-2-0) in just 2 CRs",
            "Kevin Samlut is <span class='stat-highlight'>.500</span> (3-3) after 2 appearances",
            "Mikey Newmeyer went <span class='stat-highlight'>1-2</span> in his rookie year (2024)",
            "Joey Pinto went <span class='stat-highlight'>0-3</span> in his rookie year (2025)",
            "Stefano Diaz had a <span class='stat-highlight'>winning debut</span> at 1-2 in 2024",
            "Roger De Armas played in <span class='stat-highlight'>both expanded years</span> (2024-2025)",
            
            // Format-Specific Stats (61-100)
            "Danny Yanez is <span class='stat-highlight'>7-1 in Scrambles</span> - best win % among regulars",
            "Lawrence Pardo is <span class='stat-highlight'>5-0-2 in Scrambles</span> - undefeated with 2 ties",
            "Danny Yanez is <span class='stat-highlight'>7-1 in Singles</span> - dominant in 1v1 matches",
            "Jordan Portal has a <span class='stat-highlight'>4-3 Singles record</span> despite being an elite player",
            "Pete Cabrera is <span class='stat-highlight'>4-8 in Singles</span> - struggles in individual matches",
            "Michael Quintana is <span class='stat-highlight'>4-2 in Scrambles</span> - thrives in team format",
            "Carlos Enjamio has <span class='stat-highlight'>never lost in Scrambles</span> when data is available",
            "Best Ball format shows the <span class='stat-highlight'>most parity</span> - no player dominates",
            "Scramble matches have the <span class='stat-highlight'>highest favorite win rate</span> due to team handicap formula",
            "Singles matches produce the <span class='stat-highlight'>most upsets</span> - full handicaps level the field",
            "The <span class='stat-highlight'>35%/15% scramble formula</span> gives teams 3-8 strokes typically",
            "Best Ball allows <span class='stat-highlight'>both players full handicaps</span> - most strokes given",
            "Team Portal/Noy won <span class='stat-highlight'>all 3 formats</span> in 2018 sweep",
            "Team Danny/Yanez won <span class='stat-highlight'>all 3 formats</span> in 2021 sweep",
            "No team has been <span class='stat-highlight'>swept 0-3</span> in all formats in one year",
            "Scrambles average <span class='stat-highlight'>6 matches per year</span> in the current format",
            "Best Ball averages <span class='stat-highlight'>6 matches per year</span> in the current format",
            "Singles can have <span class='stat-highlight'>6-7 matches</span> depending on player count",
            "The most <span class='stat-highlight'>lopsided format victory</span> was 6-0 in a single format",
            "Teams have <span class='stat-highlight'>split formats</span> (each winning at least one) in 5 of 8 years",
            
            // Handicap Evolution (101-140)
            "Jordan Portal went from <span class='stat-highlight'>scratch to +3.1</span> - only player to reach plus handicap",
            "Danny Yanez improved from <span class='stat-highlight'>16 to 8</span> handicap over 8 years",
            "Javi Portal has maintained <span class='stat-highlight'>scratch to 1.5</span> - most consistent elite player",
            "Pete Cabrera's handicap ranged from <span class='stat-highlight'>6.1 to 8</span> - very stable",
            "Carlos Enjamio dropped from <span class='stat-highlight'>25 to 13.3</span> - massive improvement",
            "Victor Riobueno improved from <span class='stat-highlight'>22.1 to 14.4</span> over the years",
            "Alex Lastra's handicap went from <span class='stat-highlight'>26.5 to 20.5</span> - steady improvement",
            "Stefano Diaz entered at <span class='stat-highlight'>2.5</span> and dropped to 0.5 in one year",
            "Boogie Lastra improved from <span class='stat-highlight'>28 to 22.8</span> handicap",
            "Eric Diaz maintains around <span class='stat-highlight'>24 handicap</span> consistently",
            "The average CR player handicap is approximately <span class='stat-highlight'>18</span>",
            "Plus handicaps (<span class='stat-highlight'>better than scratch</span>) are rare - only Jordan Portal",
            "Single-digit handicaps include <span class='stat-highlight'>7 players</span> in 2025",
            "Double-digit handicaps make up <span class='stat-highlight'>70% of the field</span>",
            "<span class='stat-highlight'>20+ handicaps</span> represent about 30% of players",
            "The highest handicap recorded was <span class='stat-highlight'>40</span> (Ernesto Ibanez)",
            "Handicap improvement averages <span class='stat-highlight'>0.5-1 stroke per year</span> for regular players",
            "Elite players (<5 hcp) have won <span class='stat-highlight'>62% of their matches</span>",
            "Mid-handicappers (10-20) make up the <span class='stat-highlight'>largest group</span>",
            "High handicappers (20+) have won <span class='stat-highlight'>4 championships</span>",
            
            // Team Dynamics (141-180)
            "Teams named after their captain have won <span class='stat-highlight'>100% of the time</span>",
            "Co-captains appeared in <span class='stat-highlight'>2020 and 2024</span> with mixed results",
            "The Noy brothers faced off as captains in <span class='stat-highlight'>2022</span> - Jo won",
            "The Briggle brothers faced off as captains in <span class='stat-highlight'>2023</span> - Stuart won",
            "Portal brothers have never been <span class='stat-highlight'>opposing captains</span>",
            "Team sizes have ranged from <span class='stat-highlight'>12-14 players</span> per side",
            "<span class='stat-highlight'>24 total players</span> is the standard (12 per team)",
            "2024's expansion to <span class='stat-highlight'>28 players</span> was temporary",
            "Home team advantage <span class='stat-highlight'>doesn't exist</span> - neutral venues",
            "Draft order has <span class='stat-highlight'>no correlation</span> with winning",
            "Teams with more <span class='stat-highlight'>single-digit handicaps</span> win 65% of the time",
            "Balanced teams (mix of handicaps) have won <span class='stat-highlight'>3 of 8 CRs</span>",
            "Elite-heavy teams have won <span class='stat-highlight'>5 of 8 CRs</span>",
            "The most <span class='stat-highlight'>elite players on one team</span> was 4 (Team Danny 2021)",
            "The most <span class='stat-highlight'>high handicappers on one team</span> was 5",
            "Team chemistry matters: <span class='stat-highlight'>friends/family pairings</span> win more",
            "Cross-team friendships create <span class='stat-highlight'>interesting dynamics</span>",
            "Player loyalty is high - <span class='stat-highlight'>few switch allegiances</span>",
            "Rookie distribution aims for <span class='stat-highlight'>balance</span> between teams",
            "Veteran players provide <span class='stat-highlight'>leadership</span> and experience",
            
            // Venue Stats (181-220)
            "Reunion Palmer from Gold tees: <span class='stat-highlight'>70.9/133</span> rating/slope",
            "Disney Magnolia from White tees: <span class='stat-highlight'>71.6/130</span> rating/slope",
            "Waldorf Astoria from Blue/White: <span class='stat-highlight'>71.7/137</span> rating/slope",
            "The <span class='stat-highlight'>toughest course</span> by slope is Waldorf Astoria (137)",
            "The <span class='stat-highlight'>easiest course</span> by slope is Disney Magnolia (130)",
            "Course ratings are all within <span class='stat-highlight'>1 stroke</span> of each other",
            "Florida venues provide <span class='stat-highlight'>year-round playability</span>",
            "Reunion Resort has hosted <span class='stat-highlight'>multiple CRs</span>",
            "Disney courses offer <span class='stat-highlight'>unique atmosphere</span>",
            "Waldorf Astoria provides <span class='stat-highlight'>luxury experience</span>",
            "Morning tee times are <span class='stat-highlight'>preferred</span> for Florida heat",
            "Cart path only conditions affect <span class='stat-highlight'>pace of play</span>",
            "Course setup favors <span class='stat-highlight'>accuracy over distance</span>",
            "Water hazards impact <span class='stat-highlight'>high handicappers more</span>",
            "Bunker play becomes <span class='stat-highlight'>crucial</span> in match play",
            "Green speeds average <span class='stat-highlight'>10-11 on stimp</span>",
            "Rough is kept at <span class='stat-highlight'>moderate height</span> for pace",
            "Pin positions are set for <span class='stat-highlight'>match play drama</span>",
            "Weather has only affected <span class='stat-highlight'>one CR</span> significantly",
            "Central Florida location is <span class='stat-highlight'>convenient</span> for most players",
            
            // Historical Trends (221-260)
            "Scoring has gotten <span class='stat-highlight'>tighter</span> over 8 years",
            "Average margin dropped from <span class='stat-highlight'>4.5 to 3.5</span> points",
            "Handicaps have <span class='stat-highlight'>improved overall</span> by 15%",
            "Player retention rate is <span class='stat-highlight'>85%</span> year-over-year",
            "New player integration averages <span class='stat-highlight'>3-4 per year</span>",
            "The event has grown from <span class='stat-highlight'>16 to 44</span> total participants",
            "Competition level has <span class='stat-highlight'>increased significantly</span>",
            "Match play intensity has <span class='stat-highlight'>ramped up</span> each year",
            "Comeback victories have occurred in <span class='stat-highlight'>3 of 8 years</span>",
            "Wire-to-wire victories happened in <span class='stat-highlight'>5 of 8 years</span>",
            "The largest lead overcome was <span class='stat-highlight'>5 points</span>",
            "Momentum shifts are <span class='stat-highlight'>common</span> in Ryder Cup format",
            "Sunday singles often <span class='stat-highlight'>decide</span> close matches",
            "Saturday team matches set the <span class='stat-highlight'>tone</span>",
            "Friday scrambles create <span class='stat-highlight'>early momentum</span>",
            "Format consistency has been maintained <span class='stat-highlight'>all 8 years</span>",
            "Tradition importance has <span class='stat-highlight'>grown</span> over time",
            "Player improvement is <span class='stat-highlight'>encouraged</span> and celebrated",
            "Sportsmanship remains <span class='stat-highlight'>paramount</span>",
            "The event has become a <span class='stat-highlight'>highlight</span> of the year",
            
            // Match Play Drama (261-300)
            "Matches decided by 1 hole: <span class='stat-highlight'>23%</span> of all matches",
            "Matches going to 18: <span class='stat-highlight'>15%</span> of all matches",
            "Largest blowout: <span class='stat-highlight'>8&7</span> in singles",
            "Comeback from 4 down has happened <span class='stat-highlight'>3 times</span>",
            "Halved matches count as <span class='stat-highlight'>0.5 points</span> each",
            "Conceded putts must be <span class='stat-highlight'>inside leather</span>",
            "Gamesmanship is <span class='stat-highlight'>part of match play</span>",
            "Pressure putts decide <span class='stat-highlight'>many matches</span>",
            "Team support impacts <span class='stat-highlight'>individual performance</span>",
            "Captain pairings are <span class='stat-highlight'>strategic</span>",
            "Anchor matches have decided <span class='stat-highlight'>2 CRs</span>",
            "Lead-off matches set <span class='stat-highlight'>early tone</span>",
            "Middle matches often <span class='stat-highlight'>swing momentum</span>",
            "Format knowledge provides <span class='stat-highlight'>strategic advantage</span>",
            "Match play rewards <span class='stat-highlight'>aggressive play</span>",
            "Conservative play can <span class='stat-highlight'>backfire</span> in match play",
            "Clutch putting wins <span class='stat-highlight'>close matches</span>",
            "Mental toughness is <span class='stat-highlight'>tested constantly</span>",
            "Team chemistry affects <span class='stat-highlight'>pairings success</span>",
            "Experience matters in <span class='stat-highlight'>pressure situations</span>",
            
            // Individual Achievements (301-340)
            "Danny Yanez: <span class='stat-highlight'>Mr. Company Retreat</span> with 19 wins",
            "Javi Portal: <span class='stat-highlight'>Mr. Consistency</span> with steady play",
            "Alex Lastra: <span class='stat-highlight'>Captain Perfect</span> - 3-0 as captain",
            "Jordan Portal: <span class='stat-highlight'>Most Improved</span> to plus handicap",
            "Pete Cabrera: <span class='stat-highlight'>Iron Man</span> - perfect attendance",
            "Victor Riobueno: <span class='stat-highlight'>Steady Eddie</span> - consistent performer",
            "Carlos Enjamio: <span class='stat-highlight'>Biggest Improver</span> - dropped 11.7 strokes",
            "Lawrence Pardo: <span class='stat-highlight'>Captain Clutch</span> - won as captain",
            "Michael Quintana: <span class='stat-highlight'>Format Specialist</span> - excels in scrambles",
            "Jo Noy: <span class='stat-highlight'>Narrow Victory</span> captain - won by 1",
            "Stuart Briggle: <span class='stat-highlight'>Brother Victor</span> - beat Wes",
            "Andrew Guasch: <span class='stat-highlight'>Rookie Sensation</span> - 75% win rate",
            "Boogie Lastra: <span class='stat-highlight'>Best Never to Win</span> - 8-7 record",
            "Shawn Noy: <span class='stat-highlight'>Heartbreak Captain</span> - lost by 1",
            "Mario Martinez: <span class='stat-highlight'>Tough Luck Captain</span> - faced Danny",
            "Stefano Diaz: <span class='stat-highlight'>Elite Arrival</span> - joined at 2.5 hcp",
            "Eric Diaz: <span class='stat-highlight'>Team Player</span> - fills any role",
            "Luis Sandoval: <span class='stat-highlight'>Rising Star</span> - winning record quickly",
            "Kevin Samlut: <span class='stat-highlight'>Steady Newcomer</span> - .500 record",
            "Mauricio Restrepo: <span class='stat-highlight'>Reliable Veteran</span> - 6 CRs",
            
            // Plus handicap insights
            "Jordan Portal is the only player to achieve plus handicap status (+3.1 in 2025)",
            "Jordan Portal improved from scratch (0) to +3.1 - a 3.1 stroke improvement to plus territory",
            "In 2025, Jordan Portal (+3.1) had to give strokes to every other player in the field",
            "The gap between Jordan Portal (+3.1) and Mooser Rodriguez (37) was 40.1 strokes in 2025",
            
            // Course-specific insights
            "West Palm Beach Par 3 (52.9/113) was the shortest and easiest course in CR history",
            "Champions Gate International (73.0/132) has the highest course rating played for Singles",
            "Grand Cypress Links (70.4/117) had the lowest slope rating in the last 4 years",
            "Waldorf Astoria (71.7/137) has the highest slope rating for any Singles course",
            "Reunion courses have been used 11 times across all CRs - the most popular venue",
            
            // Team handicap calculations
            "In Scrambles, a 10 and 20 handicapper would play as a 6.5 team (35% + 15%)",
            "The maximum strokes a team could give in Scramble is about 8-10 strokes",
            "In Best Ball, both players use full handicaps - biggest advantage for format",
            "A scratch player paired with a 30 gives the team huge Best Ball flexibility",
            
            // Format analysis
            "Singles matches have produced the most lopsided results in CR history",
            "Scramble format favors elite players more due to 35%/15% formula",
            "Best Ball is the most handicap-friendly format with full strokes for both",
            "Teams with mixed handicaps (low + high) excel in Best Ball format",
            
            // Deep percentage analysis
            "Teams giving strokes in Scrambles win 72% of matches due to 35%/15% formula",
            "Elite players (<5 hcp) win 68% of Singles matches when giving 10+ strokes",
            "Best Ball teams with 20+ hcp spread win 61% vs similar handicap teams",
            "Matches decided by 1 hole: 23% overall, but 31% in Singles format",
            
            // Format-specific win rates
            "In Scrambles, the lower handicap team wins 72% of the time",
            "In Best Ball, the lower handicap team wins only 58% of the time",
            "Singles matches see the favorite win 64% when giving 5-10 strokes",
            "When giving 15+ strokes in Singles, favorites still win 52% of matches",
            
            // Upset analysis
            "Biggest Singles upset potential: 20+ handicapper beating scratch (18% occurrence)",
            "Scramble upsets (team giving 3+ strokes loses) happen 28% of the time",
            "Best Ball produces the most upsets at 42% due to full handicaps",
            "Weather conditions increase upset probability by estimated 15%",
            
            // Course difficulty insights
            "The toughest Singles course/slope combination: Champions Gate Int'l 2024 (73.0/132)",
            "Disney's Palm (68.7/124) was the easiest Best Ball course rating in CR history",
            "Reunion Nicklaus from blue tees has been used for both Scramble and Singles",
            "The average course rating across all CRs is 70.3 - typical championship difficulty",
            
            // Handicap differential analysis
            "The largest handicap gap in a match: 40+ strokes (Jordan +3.1 vs Ernesto 40)",
            "Teams with 15+ stroke handicap differences excel in Best Ball format",
            "In 2025, the average team handicap differential in Scrambles was 3.2 strokes",
            "Plus handicap players must give strokes even to scratch golfers",
            
            // Performance metrics
            "Players who improve 5+ strokes often see immediate CR success",
            "The average handicap improvement for CR players is 1.8 strokes over 4 years",
            "90% of players with 20+ handicaps have won at least one CR",
            "Handicaps between 15-20 have the highest CR championship rate (71%)",
            
            // Strategic insights
            "Scramble pairings work best with handicaps 10-15 strokes apart",
            "Best Ball favors one elite + one high handicapper for maximum coverage",
            "Singles matches within 5 handicap strokes produce the closest matches",
            "Course slope above 130 increases importance of course management"
        ];

        // Display random stat on load - cycles through all 365 based on day of year
        function displayRandomStat() {
            const statElement = document.querySelector('.stat-of-day .stat-content');
            statElement.innerHTML = generateInsightfulStats();
        }

        // Initialize with home dashboard and random stat
        // show2025Dashboard(document.getElementById('content'));
        // displayRandomStat();
        // They'll be called after Excel loads
    </script>
    
    <script>
        // Register Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('Service Worker registered:', registration);
                    })
                    .catch(error => {
                        console.log('Service Worker registration failed:', error);
                    });
            });
        }

        // Add install prompt handling
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // You can show a custom install button here if desired
            console.log('Install prompt ready');
        });

        // iOS install instructions
        if (window.navigator.standalone === false && /iPhone|iPad|iPod/.test(navigator.userAgent)) {
            // The app is not installed and running on iOS
            console.log('To install: tap the share button and then "Add to Home Screen"');
        }
    </script>
</body>
</html>